

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon/warning.png">
  <link rel="icon" href="/img/icon/warning.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="K0rz3n">
  <meta name="keywords" content="">
  
    <meta name="description" content="0X01 概念：APT，又称高级持续性威胁，通常用于区分由国家、政府或情报机构资助或具有相关背景的攻击团伙实施的攻击行动。该类攻击行动的动机往往与地缘政治冲突，军事行动相关，并以长久性的情报刺探、收集和监控为主要意图，其主要攻击的目标除了政府、军队、外交相关部门外，也包括科研、海事、能源、高新技术等领域。  0X02 高级持续性威胁背后的攻击者1.APT28Zebrocy 是APT28 专用的攻击">
<meta property="og:type" content="article">
<meta property="og:title" content="APT(高级持续威胁) 概念以及趋势概述">
<meta property="og:url" content="http://k0rz3n.com/2019/03/21/APT(%E9%AB%98%E7%BA%A7%E6%8C%81%E7%BB%AD%E5%A8%81%E8%83%81)%20%E6%A6%82%E5%BF%B5%E4%BB%A5%E5%8F%8A%E8%B6%8B%E5%8A%BF%E6%A6%82%E8%BF%B0/index.html">
<meta property="og:site_name" content="K0rz3n&#39;s Blog">
<meta property="og:description" content="0X01 概念：APT，又称高级持续性威胁，通常用于区分由国家、政府或情报机构资助或具有相关背景的攻击团伙实施的攻击行动。该类攻击行动的动机往往与地缘政治冲突，军事行动相关，并以长久性的情报刺探、收集和监控为主要意图，其主要攻击的目标除了政府、军队、外交相关部门外，也包括科研、海事、能源、高新技术等领域。  0X02 高级持续性威胁背后的攻击者1.APT28Zebrocy 是APT28 专用的攻击">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B31.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B32.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B311.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B312.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B313.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B33.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B37.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B38.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B34.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B35.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B39.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B310.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B36.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B314.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B315.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B316.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B317.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B318.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B319.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B320.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B321.jpg">
<meta property="og:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B322.jpg">
<meta property="article:published_time" content="2019-03-21T19:28:18.000Z">
<meta property="article:modified_time" content="2025-01-24T15:18:52.486Z">
<meta property="article:author" content="K0rz3n">
<meta property="article:tag" content="APT">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B31.jpg">
  
  
  
  <title>APT(高级持续威胁) 概念以及趋势概述 - K0rz3n&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/macpanel.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"k0rz3n.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 60vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>K0rz3n&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/banner/icemountain.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="APT(高级持续威胁) 概念以及趋势概述"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2019-03-21 19:28" pubdate>
          March 21, 2019 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          4.5k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          38 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">APT(高级持续威胁) 概念以及趋势概述</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="0X01-概念："><a href="#0X01-概念：" class="headerlink" title="0X01 概念："></a><strong>0X01 概念：</strong></h2><p>APT，又称<strong>高级持续性威胁</strong>，通常<strong>用于区分由国家、政府或情报机构资助或具有相关背景的攻击团伙实施的攻击行动</strong>。该类攻击行动的动机往往与地缘<strong>政治冲突，军事行动</strong>相关，并以<strong>长久性的情报刺探、收集和监控</strong>为主要意图，其主要攻击的目标除了<strong>政府、军队、外交相关部门外，也包括科研、海事、能源、高新技术</strong>等领域。 </p>
<h2 id="0X02-高级持续性威胁背后的攻击者"><a href="#0X02-高级持续性威胁背后的攻击者" class="headerlink" title="0X02 高级持续性威胁背后的攻击者"></a><strong>0X02 高级持续性威胁背后的攻击者</strong></h2><h3 id="1-APT28"><a href="#1-APT28" class="headerlink" title="1.APT28"></a><strong>1.APT28</strong></h3><p><strong>Zebrocy 是APT28 专用的攻击工具集</strong>，主要目的是用作侦察（收集上传系统信息和截屏）和部署下一阶段的攻击载荷。Zebrocy 包含了.NET、AutoIT、Delphi、C++、PowerShell 和Go 等多种语言开发形态。安全厂商也发现该组织使用新的攻击恶意代码Cannon，<strong>其使用邮件协议作为C2的通信方式。</strong></p>
<h3 id="2-APT29"><a href="#2-APT29" class="headerlink" title="2.APT29"></a><strong>2.APT29</strong></h3><p>其实施鱼叉攻击是用于投放恶意的LNK文件，其中利用了该组织特有的一种LNK文件格式的利用技术。该组织木马会执行内嵌的PowerShell脚本命令,<strong>并从LNK 文件附加的数据中解密释放恶意载荷和诱导的PDF 文档文件</strong>。</p>
<span id="more"></span>

<h3 id="3-Lazarus-Group"><a href="#3-Lazarus-Group" class="headerlink" title="3.Lazarus Group"></a><strong>3.Lazarus Group</strong></h3><h3 id="4-肚脑虫（APT-C-35）"><a href="#4-肚脑虫（APT-C-35）" class="headerlink" title="4.肚脑虫（APT-C-35）"></a><strong>4.肚脑虫（APT-C-35）</strong></h3><p>其主要<strong>针对巴基斯坦和克什米尔地区</strong>的目标人员。该组织使用了两种特定的攻击恶意框架，EHDevel 和 yty，命名取自恶意代码中的 PDB 路径信息。<strong>该组织使用的攻击载荷使用了多种语言开发，包括C++、.NET、Python、VBS 和AutoIt</strong>。</p>
<p>360 威胁情报中心发现了该组织以“克什米尔问题”命名的<strong>诱饵漏洞文档，该文档利用了CVE-2017-8570 漏洞</strong>，其主要的攻击流程如下图。</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B31.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p>后续又发现该组织利用<strong>内嵌有恶意宏代码的 Excel 文档</strong>针对中国境内的巴基斯坦重要商务人士实施的攻击<a target="_blank" rel="noopener" href="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B33.jpg">6</a>，并向被控主机下发了多种载荷模块文件。</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B32.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<h3 id="5-蔓灵花"><a href="#5-蔓灵花" class="headerlink" title="5.蔓灵花"></a><strong>5.蔓灵花</strong></h3><p>蔓灵花组织主要使用鱼叉邮件向目标人员投放<strong>漏洞利用文档</strong>，其中包括针对 <strong>Office 的漏洞文档和InPage 文字处理软件的漏洞文档</strong>（InPage 是一个专门针对乌尔都语使用者，即巴基斯坦国语设计的文字处理软件）。</p>
<p>该组织主要使用鱼叉钓鱼进行攻击，投递伪装成word图标的自解压文件：</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B311.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B312.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p>运行后，除了会执行恶意文件外，还会打开一个doc文档，用于迷惑用户，让用户以为打开的文件就是一个doc文档。诱饵文档内容极尽诱惑力：</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B313.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p>最终会下发键盘记录、上传文件、远控等插件，完成资料的窃取工作。</p>
<h3 id="6-Group-123-APT37"><a href="#6-Group-123-APT37" class="headerlink" title="6.Group 123(APT37)"></a><strong>6.Group 123(APT37)</strong></h3><p>Group 123 组织早期的攻击活动主要针对韩国，2017 年后延伸攻击目标至半岛范围，包括日本，越南和中东。其主要针对工业垂直领域，包括化学品、电子、制造、航空航天、汽车和医疗保健实体。360 威胁情报中心也曾发现该组织针对中国境内目标的攻击活动。</p>
<p>该组织在过去实施的攻击活动中主要<strong>以情报窃取为意图</strong>，并呈现出一些其<strong>特有的战术技术特点</strong>，包括：<br>1） 同时拥有对 PC（Windows） 和 Android 终端的攻击武器；<br>2） 对韩国网站实施入侵并作为攻击载荷分发和控制回传渠道，或者使用云盘，如 Yandex、Dropbox 等作为攻击载荷分发和控制回传渠道；<br>3） 使用 HWP 漏洞对韩国目标人员实施鱼叉攻击。</p>
<h2 id="0X03-针对中国境内的APT-组织和威胁"><a href="#0X03-针对中国境内的APT-组织和威胁" class="headerlink" title="0X03 针对中国境内的APT 组织和威胁"></a><strong>0X03 针对中国境内的APT 组织和威胁</strong></h2><h3 id="1-海莲花（APT-C-00）"><a href="#1-海莲花（APT-C-00）" class="headerlink" title="1.海莲花（APT-C-00）"></a><strong>1.海莲花（APT-C-00）</strong></h3><p>在2018 年中的全球高级持续性威胁报告中，我们总结了该组织使用的攻击战术和技术特点，包括使用开源的代码和公开的攻击工具，如Cobalt Strike。</p>
<p>“海莲花”在2018 年的攻击活动中使用了<strong>更加多样化的载荷投放形式</strong>，并使用<strong>多种白利用技术</strong>加载其恶意模块。</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B33.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p>还使用一些脚本技术</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B37.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p>最终在内存中调用loader类，加载最终的由CobaltStrike生成的beacon.dll木马：</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B38.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p><strong>该组织在近期活动中主要的攻击过程如下</strong></p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B34.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<h3 id="2-毒云藤（APT-C-01）"><a href="#2-毒云藤（APT-C-01）" class="headerlink" title="2.毒云藤（APT-C-01）"></a><strong>2.毒云藤（APT-C-01）</strong></h3><p>毒云藤（APT-C-01），也被国内其他安全厂商称为穷奇、绿斑。该组织从2007 年开始至今，对中国国防、政府、科技、教育以及海事机构等重点单位和部门进行了长达11 年的网络间谍活动。<strong>该组织主要关注军工、中美关系、两岸关系和海洋相关领域。</strong></p>
<p>该组织主要使用<strong>鱼叉攻击投放漏洞文档或二进制可执行文件</strong>。下面两图为我们截获的该组织鱼叉邮件内容。<br>毒云藤组织主要使用的恶意木马包括Poison Ivy，ZxShell，XRAT 等，并<strong>使用动态域名，云盘，第三方博客作为其控制回传的基础设施</strong></p>
<h3 id="3-蓝宝菇（APT-C-12）"><a href="#3-蓝宝菇（APT-C-12）" class="headerlink" title="3.蓝宝菇（APT-C-12）"></a><strong>3.蓝宝菇（APT-C-12）</strong></h3><p>蓝宝菇（APT-C-12）组织的活动最早从2011 年开始并持续至今**，对我国政府、军工、科研、金融等重点单位和部门进行了持续的网络间谍活动**。</p>
<p>该组织主要关注核工业和科研等相关信息。被攻击目标主要集中在中国大陆境内。在2018 年中的高级持续性威胁报告中曾对该组织进行了介绍。蓝宝菇组织也主要使用<strong>鱼叉邮件实施攻击，其投放的文件主要是RLO伪装成文档的可执行文件或LNK 格式文件</strong>。</p>
<p>该组织主要使用<strong>动态域名或IDC IP 最为其控制基础设施</strong>，<strong>后续也常使用AWSS3、新浪云等云服务</strong>作为其上传和托管窃取的数据。其常使用的恶意程序包括<strong>Poison Ivy、Bfnet，以及PowerShell 实现的后门。</strong></p>
<p>蓝宝菇和毒云藤两个组织从攻击来源来源来看，属于同一地域，但使用的TTP(策略技术流程)却存在一些差异。</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B35.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<h3 id="4-Darkhotel（APT-C-06）"><a href="#4-Darkhotel（APT-C-06）" class="headerlink" title="4.Darkhotel（APT-C-06）"></a><strong>4.Darkhotel（APT-C-06）</strong></h3><p>趋势科技在2018 年7 月公开捕获了又一例<strong>VBScript Engine 的在野0day漏洞</strong>（CVE-2018-8373）攻击样本。360 威胁情报中心结合内部的威胁情报数据关联到该在野攻击与 Darkhotel 有关，该组织在2018 年多次利用 VBScript Engine 的相关0day 漏洞实施在野攻击活动。</p>
<p><strong>该组织的一大特色是喜欢把木马隐藏在开源的代码中进行伪装</strong>，如putty、openssl、zlib等，把少量木马代码隐藏在大量的开源代码中，从而实现躲避检测的目的，<strong>因此将被称为“寄生兽”。</strong></p>
<p>如使用msfte.dll和msTracer.dll，来进行持久性攻击，并把下发的shellcode隐藏在图片文件中</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B39.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p>同时通过下发插件的方式，完成相关的任务：</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B310.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p><strong>该组织的具体攻击流程如下图：</strong></p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B36.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<h2 id="0X04-APT-威胁的现状和挑战"><a href="#0X04-APT-威胁的现状和挑战" class="headerlink" title="0X04 APT 威胁的现状和挑战"></a><strong>0X04 APT 威胁的现状和挑战</strong></h2><h3 id="1-进化中的APT-攻防"><a href="#1-进化中的APT-攻防" class="headerlink" title="1.进化中的APT 攻防"></a><strong>1.进化中的APT 攻防</strong></h3><p>APT 组织也不再局限于其过去固有的攻击模式和武器，APT 组织不仅需要达到最终的攻击效果，还刻意避免被防御方根据留下的痕迹和特征追溯到其组织身份(false flag)。</p>
<h4 id="1-常见的APT攻击方式"><a href="#1-常见的APT攻击方式" class="headerlink" title="(1)常见的APT攻击方式"></a><strong>(1)常见的APT攻击方式</strong></h4><h5 id="1-鱼叉攻击"><a href="#1-鱼叉攻击" class="headerlink" title="1.鱼叉攻击"></a><strong>1.鱼叉攻击</strong></h5><p>2018年，<strong>鱼叉攻击依然是APT攻击的最主要方式</strong>，使用<strong>鱼叉结合社工类的方式，投递带有恶意文件的附件，诱使被攻击者打开</strong>。虽然该方式攻击成本极低，但是效果却出人意料的好。这也进一步体现了被攻击目标的人员的安全意识亟需加强。从曝光的APT活动来看，2018年使用鱼叉攻击的APT活动比例高达95%以上。</p>
<h5 id="2-水坑攻击"><a href="#2-水坑攻击" class="headerlink" title="2.水坑攻击"></a><strong>2.水坑攻击</strong></h5><p><strong>水坑攻击也是APT组织常用的攻击手段</strong>，2018年，海莲花、socketplayer等组织均使用过该攻击方式。除了插恶意代码外，<strong>攻击者还会判断访问该页面的访问者的ip，只有当访问者在攻击目标的ip范围内，才会进行下一步的攻击动作，依次来防止误伤</strong>。</p>
<h5 id="3-远程可执行漏洞和密码爆破攻击"><a href="#3-远程可执行漏洞和密码爆破攻击" class="headerlink" title="3.远程可执行漏洞和密码爆破攻击"></a><strong>3.远程可执行漏洞和密码爆破攻击</strong></h5><p>除了鱼叉和水坑攻击，利用远程可执行漏洞和服务器口令爆破进行攻击，也成为了一种可选的攻击方式。如专业黑客组织针对驱动人生公司的攻击，该黑客组织得手后已对普通网民产生极大威胁。</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B314.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<h4 id="2-APT攻击的技术趋势"><a href="#2-APT攻击的技术趋势" class="headerlink" title="(2)APT攻击的技术趋势"></a><strong>(2)APT攻击的技术趋势</strong></h4><h5 id="1-Fileless攻击（无文件攻击）越来越多"><a href="#1-Fileless攻击（无文件攻击）越来越多" class="headerlink" title="1.Fileless攻击（无文件攻击）越来越多"></a><strong>1.Fileless攻击（无文件攻击）越来越多</strong></h5><p>随着各安全厂商对PE文件的检测和防御能力不断的增强，A<strong>PT攻击者越来越多的开始使用无PE文件落地的攻击方式进行攻击</strong>。其主要特点是<strong>没有长期驻留在磁盘的文件、核心payload存放在网络或者注册表</strong>中，启动后通过系统进程<strong>拉取payload执行</strong>。该方式大大增加了客户端安全软件基于文件扫描的防御难度。海莲花、污水（MuddyWater）、APT29、FIN7等攻击组织都擅长使用该方式进行攻击。</p>
<p>如海莲花组织事先的通过计划任务执行命令，全程无文件落地：</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B315.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<h5 id="2-C-C存放在公开的社交网站上"><a href="#2-C-C存放在公开的社交网站上" class="headerlink" title="2.C&amp;C存放在公开的社交网站上"></a><strong>2.C&amp;C存放在公开的社交网站上</strong></h5><p><strong>通信跟数据回传是APT攻击链中非常重要的环节</strong>，因此如何使得通信的C&amp;C服务器被防火墙发现成为了攻击者的难题。因此，<strong>除了注册迷惑性极强的域名、使用DGA、隐蔽信道等方式外，攻击者把目光集中到了公开的社交网络上，如youtube、github、twitter等上。</strong></p>
<p>如某次针对英国和瑞士的攻击，C&amp;C存放地址：</p>
<p>YouTube：</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B316.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p> Twitter：</p>
<p> <img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B317.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p> Wordpress博客：</p>
<p> <img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B318.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p> Google plus：</p>
<p> <img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B319.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<h5 id="3-公开或者开源工具的使用"><a href="#3-公开或者开源工具的使用" class="headerlink" title="3.公开或者开源工具的使用"></a><strong>3.公开或者开源工具的使用</strong></h5><p>往往，APT组织都有其自己研发的特定的攻击武器库，但是随着安全厂商对APT组织研究的深入，APT组织开始使<strong>用一些公开或者开源的工具来进行攻击，以此来增加溯源以及被发现的难度。</strong></p>
<p>如SYSCON&#x2F;KONNI，使用开源的babyface木马和无界面的teamview（著名远程控制工具）来进行攻击：</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B320.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<h5 id="4-多平台攻击和跨平台攻击"><a href="#4-多平台攻击和跨平台攻击" class="headerlink" title="4.多平台攻击和跨平台攻击"></a><strong>4.多平台攻击和跨平台攻击</strong></h5><p>移动互联网的成熟，使得人们已经很少在工作之余使用电脑，因此<strong>使用移动端来进行攻击，也越来越被APT攻击组织使用</strong>。此外Mac OS的流行，也是的APT攻击者也开始对MacOS平台进行攻击。如“人面马”(APT34)、蔓灵花、Group123、双尾蝎（APT-C-23）、黄金鼠（APT-C-27）等组织都擅长使用多平台攻击。此外黄金鼠（APT-C-27）还使用了在APK中打包了PE文件，运行后释放到移动端外置存储设备中的图片目录下，从而实现跨平台的攻击：</p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B321.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<p><img src="https://picture-1253331270.cos.ap-beijing.myqcloud.com/APT%E7%9B%B8%E5%85%B322.jpg" srcset="/img/loading.gif" lazyload alt="此处输入图片的描述"></p>
<h3 id="2-多样化的攻击投放方式"><a href="#2-多样化的攻击投放方式" class="headerlink" title="2.多样化的攻击投放方式"></a><strong>2.多样化的攻击投放方式</strong></h3><h4 id="1-文档投放的形式多样化"><a href="#1-文档投放的形式多样化" class="headerlink" title="(1)文档投放的形式多样化"></a><strong>(1)文档投放的形式多样化</strong></h4><p>在过去的APT 威胁或者网络攻击活动中，利用邮件投递恶意的文档类载荷是非常常见的一种攻击方式，例如<strong>鱼叉邮件攻击或BEC 攻击，垃圾邮件攻击等</strong>。而<strong>通常投放的文档大多为Office 文档类型，如doc、docx，xls，xlsx 等。</strong></p>
<p>针对特定地区、特定语言或者特定行业的目标人员，攻击者可能会投放一些其他的文档类型载荷，例如<strong>针对韩国人员投放HWP 文档</strong>，<strong>针对巴基斯坦地区投放InPage 文档</strong>，或者针对<strong>工程建筑行业人员投放恶意的<br>AutoCAD</strong> 文档等等。</p>
<p>攻击者也可能使用一些<strong>其他扩展名的文档类型</strong>并同样可以被Office 应用打开**，如.iqy，**虽然其在APT 威胁中不是很常见，但已经应用在一些更广泛的垃圾邮件攻击活动中。</p>
<h4 id="2-利用文件格式的限制"><a href="#2-利用文件格式的限制" class="headerlink" title="(2)利用文件格式的限制"></a><strong>(2)利用文件格式的限制</strong></h4><p>APT 攻击者通常会利用一些文件格式和<strong>显示上的特性</strong>用于<strong>迷惑受害用户或安全分析人员</strong>。这里以LNK 文件为例。<strong>LNK 文件显示的目标执行路径仅260 个字节，多余的字符将被截断</strong>，</p>
<p>而在跟踪蓝宝菇的攻击活动中，<strong>该组织投放的LNK 文件在目标路径字符串前面填充了大量的空字符，所以直接查看无法明确其执行的内容，需要解析LNK 文件结构获取</strong>,APT29 也常用这种方式执行PowerShell 脚本</p>
<h4 id="3-利用新的系统文件格式特性"><a href="#3-利用新的系统文件格式特性" class="headerlink" title="(3)利用新的系统文件格式特性"></a><strong>(3)利用新的系统文件格式特性</strong></h4><p>2018 年6 月，国外安全研究人员公开了利用<strong>Windows 10 下才被引入的新文件类型“.SettingContent-ms”执行任意命令的攻击技巧</strong>，并公开了POC。而该新型攻击方式被公开后就立刻<strong>被黑客和APT组织纳入攻击武器库用于针对性攻击，并衍生出各种利用方式</strong>：诱导执行、利用Office 文档执行、利用PDF 文档执行。</p>
<h4 id="4-利用旧的技术实现攻击"><a href="#4-利用旧的技术实现攻击" class="headerlink" title="(4)利用旧的技术实现攻击"></a><strong>(4)利用旧的技术实现攻击</strong></h4><p>一些被认为<strong>陈旧而古老的文档特性可以被实现并用于攻击</strong>，360 威胁情报中心在2018 年就针对利用Excel 4.0 宏传播商业远控木马的在野攻击样本进行了分析。该技术最早是于2018 年10 月6 日由国外安全厂商Outflank的安全研究人员首次公开，并展示了使用Excel 4.0 宏执行ShellCode 的利用<br>代码**。Excel 4.0 宏是一个很古老的宏技术，微软在后续使用VBA 替换了该特性，但从利用效果和隐蔽性上依然能够达到不错的效果**</p>
<h3 id="3-0day-漏洞和在野利用"><a href="#3-0day-漏洞和在野利用" class="headerlink" title="3.0day 漏洞和在野利用"></a><strong>3.0day 漏洞和在野利用</strong></h3><p>0day 漏洞的在野利用，一般是指攻击活动被捕获时，发现其利用了某些0day 漏洞（攻击活动与攻击样本分析本身也是0day 漏洞发现的重要方法之一）。而在所有有能力挖掘和利用0day 漏洞的组织中，<strong>APT 组织首当其冲。</strong></p>
<p>0day 漏洞在野利用的频频现身，事实上是在<strong>倒逼安全企业必须打破传统的攻防理念</strong>，实现安全能力的大幅提升与技术体系的全面升级。这主要表现在两个方面：</p>
<h4 id="1-安全企业必须在漏洞挖掘和攻防能力建设上进行持续的投入"><a href="#1-安全企业必须在漏洞挖掘和攻防能力建设上进行持续的投入" class="headerlink" title="(1)安全企业必须在漏洞挖掘和攻防能力建设上进行持续的投入"></a><strong>(1)安全企业必须在漏洞挖掘和攻防能力建设上进行持续的投入</strong></h4><p>从某种程度上来说，0day 漏洞的独立发现能力，已经成为APT 研究的必备技能，也是衡量安全厂商在APT 方面攻防水平的重要指标之一。</p>
<h4 id="2-大数据和威胁情报能力将成为新型IT-基础设施安全体系建设的关键"><a href="#2-大数据和威胁情报能力将成为新型IT-基础设施安全体系建设的关键" class="headerlink" title="(2)大数据和威胁情报能力将成为新型IT 基础设施安全体系建设的关键"></a><strong>(2)大数据和威胁情报能力将成为新型IT 基础设施安全体系建设的关键</strong></h4><p>因为从理论上说，<strong>0day 漏洞利用是不可防御的</strong>；既然防不住，<strong>就应该更多的从快速发现、快速响应来着手</strong>建设新的安全体系，而大数据和威胁情报能力正是这种体系的核心和关键。</p>
<h2 id="0X05-APT-威胁到归属挑战"><a href="#0X05-APT-威胁到归属挑战" class="headerlink" title="0X05 APT 威胁到归属挑战"></a><strong>0X05 APT 威胁到归属挑战</strong></h2><p>APT 威胁活动的归属分析一直是APT 威胁分析中最为重要的一个环节，目前，<strong>绝大多数安全机构在做APT 活动的归属分析时，主要的判断依据包括以下几点：</strong></p>
<p>1） APT 组织使用的<strong>恶意代码特征的相似度</strong>，如包含特有的元数据，互斥量，加密算法，签名等等。<br>2） APT 组织历史使用<strong>控制基础设施的重叠</strong>，本质即pDNS 和whois 数据的重叠。<br>3） APT 组织使用的<strong>攻击TTP</strong>。<br>4） 结合攻击留下的线索中<strong>的地域和语言特征，或攻击针对的目标和意图</strong>，推测其攻击归属的APT 组织<br>5） <strong>公开情报</strong>中涉及的归属判断依据</p>
<p>但APT <strong>攻击者会尝试规避和隐藏攻击活动中留下的与其角色相关的线索，或者通过false flag（假旗行动）和模仿其他组织的特征来迷惑分析人员</strong>。针对韩国平昌奥运会的攻击组织Hades 就是一个最好的说明。</p>
<h2 id="0X06-APT-威胁的演变趋势"><a href="#0X06-APT-威胁的演变趋势" class="headerlink" title="0X06 APT 威胁的演变趋势"></a><strong>0X06 APT 威胁的演变趋势</strong></h2><p>从2018 年的APT 威胁态势来看，我们推测APT 威胁<strong>活动的演变趋势可能包括如下几个方面：</strong></p>
<p>1） <strong>APT 组织可能发展出更加明确的组织化特点</strong>，例如小组化，各个攻击小组可能针对特定行业实施攻击并达到特定的攻击目的，但其整体可能共享部分攻击代码或资源。</p>
<p>2） APT 组织在初期的攻击尝试和获得初步控制权阶段可能<strong>更倾向于使用开源或公开的攻击工具或系统工具，只有对高价值目标或为维持长久性的控制时，才会使用其自身特有的成熟的攻击代码。</strong></p>
<p>3） APT 组织针对的目标行业可能进一步**延伸到一些传统行业或者和国家关键信息基础建设相关的行业和机构。**随着这些行业逐渐的互联化和智能化，其安全防御上的弱点将会被越来越多的利用，供应链攻击也会越来越频繁。</p>
<p>4） <strong>APT 组织会进一步加强0day漏洞能力的储备</strong>，并且可能覆盖多个平台，包括PC，服务器，移动终端，路由器，甚至<strong>工控设备</strong>等。</p>
<h2 id="0X07-参考链接"><a href="#0X07-参考链接" class="headerlink" title="0X07 参考链接"></a><strong>0X07 参考链接</strong></h2><p><a target="_blank" rel="noopener" href="https://s.tencent.com/research/report/623.html">https://s.tencent.com/research/report/623.html</a><br><a target="_blank" rel="noopener" href="http://zt.360.cn/1101061855.php?dtid=1101062514&did=210827151">http://zt.360.cn/1101061855.php?dtid=1101062514&amp;did=210827151</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/APT/" class="category-chain-item">APT</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/APT/" class="print-no-link">#APT</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>APT(高级持续威胁) 概念以及趋势概述</div>
      <div>http://k0rz3n.com/2019/03/21/APT(高级持续威胁) 概念以及趋势概述/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>K0rz3n</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>March 21, 2019</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - Non-commercial">
                    <i class="iconfont icon-cc-nc"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - Share-alike">
                    <i class="iconfont icon-cc-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2019/03/23/2018%20APT%20(Advanced%20Persistent%20Threat)%E6%94%BB%E5%87%BB%E5%A4%A7%E4%BA%8B%E4%BB%B6/" title="2018 APT (Advanced Persistent Threat)攻击大事件">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">2018 APT (Advanced Persistent Threat)攻击大事件</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2019/03/19/%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5%E6%A6%82%E5%BF%B5%E4%B8%8EAPT%E4%BA%8B%E4%BB%B6%E5%88%86%E6%9E%90%E6%A8%A1%E5%9E%8B%E6%A6%82%E8%BF%B0/" title="威胁情报概念与APT事件分析模型概述">
                        <span class="hidden-mobile">威胁情报概念与APT事件分析模型概述</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
