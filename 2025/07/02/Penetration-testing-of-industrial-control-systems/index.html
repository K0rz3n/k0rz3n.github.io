

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon/warning.png">
  <link rel="icon" href="/img/icon/warning.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="K0rz3n">
  <meta name="keywords" content="">
  
    <meta name="description" content="IntroductionThe penetration testing report for the ICS was completed by our team, with the goal of identifying as many risks as possible within industrial control systems. Starting from asset collecti">
<meta property="og:type" content="article">
<meta property="og:title" content="Penetration testing of Industrial Control Systems(ICS)">
<meta property="og:url" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/index.html">
<meta property="og:site_name" content="K0rz3n&#39;s Blog">
<meta property="og:description" content="IntroductionThe penetration testing report for the ICS was completed by our team, with the goal of identifying as many risks as possible within industrial control systems. Starting from asset collecti">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image1.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image2.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image3.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image4.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/table1.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/table1-1.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/table2.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/table2-1.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/table3.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image5.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image6.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image7.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image8.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image9.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image10.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image11.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image12.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image13.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image14.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image15.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image16.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image17.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image18.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image19.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image20.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image21.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image22.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image23.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image24.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image25.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image26.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image27.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image28.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image29.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image30.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image31.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image32.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image33.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image34.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image35.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image36.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image37.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image38.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image39.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image40.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image41.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image42.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/tank.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image43.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image44.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image45.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image46.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image47.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image48.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image49.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image50.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image51.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image52.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image53.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image54.png">
<meta property="article:published_time" content="2025-07-02T19:20:10.000Z">
<meta property="article:modified_time" content="2025-08-20T19:38:35.126Z">
<meta property="article:author" content="K0rz3n">
<meta property="article:tag" content="工控安全">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/image1.png">
  
  
  
  <title>Penetration testing of Industrial Control Systems(ICS) - K0rz3n&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/macpanel.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"k0rz3n.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 60vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>K0rz3n&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/banner/icemountain.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Penetration testing of Industrial Control Systems(ICS)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-07-02 20:20" pubdate>
          July 2, 2025 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.1k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          10 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Penetration testing of Industrial Control Systems(ICS)</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>The penetration testing report for the ICS was completed by our team, with the goal of identifying as many risks as possible within industrial control systems. Starting from asset collection, we continuously attempted to discover new risk points within the system and combined them to escalate privileges,and draw the architectural diagram we understand. We exploited protocol vulnerabilities to remotely control the industrial tank. I primarily focused on the penetration testing aspect, while other team members participated in the penetration and were responsible for drafting the report. The testing was conducted entirely in a controlled environment, with no real-world disruptions.</p>
<h2 id="Methodology-Overview"><a href="#Methodology-Overview" class="headerlink" title="Methodology Overview"></a>Methodology Overview</h2><p>In this experiment, a systematic penetration testing approach is usedin. The process of attack consists of several steps:</p>
<p><strong>Information Gathering and Asset Identification.</strong> We performedextensive network scanning using tools such as Nmap to map theinfrastructure across multiple subnets (Field, Layer 3, and Cloudnetworks). The scans were used to identify active hosts, open ports,running services, and operating systems. This phase enabled us to builda comprehensive asset inventory and provided a baseline for furthervulnerability assessment.</p>
<p><strong>Vulnerability Assessment and Analysis.</strong> Based on the scan results, weanalyzed each asset for potential vulnerabilities. This includedidentifying misconfigurations, default credentials, outdatedcertificates, and known vulnerabilities such as EternalBlue(CVE-2017-0144) on Windows systems. We used both automated tools (e.g.,Metasploit modules) and manual verification to confirm the presence ofvulnerabilities.</p>
<p><strong>Exploitation and Proof of Concept.</strong> Where applicable and within thebounds of our test environment, we exploited the identifiedvulnerabilities to demonstrate their impact. For instance, we usedMetasploit to verify the existence of the EternalBlue vulnerability onWindows hosts and accessed the camera feed via weak credentials. Theseproofs-of-concept helped illustrate the real-world risk associated witheach vulnerability.</p>
<p><strong>Mitigation Recommendations.</strong> Following the exploitation, weformulated a set of mitigations for each identified vulnerability.Recommendations include updating patches, disabling outdated protocols(e.g., SMBv1), strengthening authentication mechanisms, and restrictingnetwork access via segmentation and firewall rules.</p>
<h1 id="Asset-Inventory"><a href="#Asset-Inventory" class="headerlink" title="Asset Inventory"></a>Asset Inventory</h1><h2 id="Environment-Setup"><a href="#Environment-Setup" class="headerlink" title="Environment Setup"></a>Environment Setup</h2><p>In lab environment, attacker (kali) is bridged to connect to eth5. The192.168.5.0&#x2F;24 network belongs to the private IP address range definedby RFC1918 [3], which allows the lab environment to maintain internalcommunication while being isolated from external networks. The provided<em>OpenVPN</em> was deployed by configuration file to attacker machine andconnected the VPN client to the specified server, successfullyestablishing a secure tunnel to the lab environment.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> openvpn --config ./client.ovpn<br></code></pre></td></tr></table></figure>

<p>After verification, our terminal successfully obtained an IP addressfrom the 192.168.5.0&#x2F;24 network through the VPN shown in Figure 1 andwas able to access the devices and services within that subnet.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image1.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Successfully OpenVPN connect to remote host.</p>
<h2 id="Identifying-Active-Hosts"><a href="#Identifying-Active-Hosts" class="headerlink" title="Identifying Active Hosts"></a>Identifying Active Hosts</h2><p>After connecting to the internal network, the first step is to identifyall devices within the three network segments. The following commandsare used to scan each segment for all visible IPs, while the scanresults shown in Figure 2.</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nmap</span> -sn <span class="hljs-number">172.20.1.0</span>/<span class="hljs-number">24</span><br></code></pre></td></tr></table></figure>

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image2.png" srcset="/img/loading.gif" lazyload class=""> 

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image3.png" srcset="/img/loading.gif" lazyload class="">                                        

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image4.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : nmap scan result for three network segments. The left image forthe result of 172.20.1.0&#x2F;24; the top-right image shows the result of172.20.50.0&#x2F;24; the bottom-right image presents the result of10.150.20.0&#x2F;24</p>
<h2 id="Service-Discovery"><a href="#Service-Discovery" class="headerlink" title="Service Discovery"></a>Service Discovery</h2><p>Building on the initial identification of active devices, <em>nmap</em> is usedfor further service and port scanning. The discovered IPs are stored inthree separate TXT files, which Nmap processes to perform acomprehensive scan on each listed IP. The active services in Bristolcyber security testbed is shown in Table 1, Table 2, Table 3.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/table1.png" srcset="/img/loading.gif" lazyload class=""> 

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/table1-1.png" srcset="/img/loading.gif" lazyload class=""> 

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/table2.png" srcset="/img/loading.gif" lazyload class="">                    

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/table2-1.png" srcset="/img/loading.gif" lazyload class="">  

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/table3.png" srcset="/img/loading.gif" lazyload class="">  



<p>The following three images show our Nmap scans for the 172.20.1.0&#x2F;24,172.20.50.0&#x2F;24, and 10.150.20.0&#x2F;24 networks, which helped us identifythe IP addresses present in each subnet.</p>
<h1 id="Survey-of-Testbed"><a href="#Survey-of-Testbed" class="headerlink" title="Survey of Testbed"></a>Survey of Testbed</h1><p>In this section, it outlines the process we followed to discovervulnerabilities and attempt their exploitation in the testbed. Based onour scanning results, we began by accessing all ports providing HTTPservices. For each open port, we manually reviewed the content toconfirm the target system and identify potential weak points. Eachtarget was then systematically tested by sending crafted requests andemploying known exploitation techniques, using automated tools such asnmap and manual interactions to understand service behavior and confirmvulnerabilities. The results of our experiments were compared to servicecharacteristics by repeatedly testing each HTTP port to identifyexploitable weaknesses.</p>
<h2 id="EternalBlue-Vulnerability-Main-Victim-172-20-1-70-172-20-50-160"><a href="#EternalBlue-Vulnerability-Main-Victim-172-20-1-70-172-20-50-160" class="headerlink" title="EternalBlue Vulnerability (Main Victim: 172.20.1.70 &amp; 172.20.50.160)"></a>EternalBlue Vulnerability (Main Victim: 172.20.1.70 &amp; 172.20.50.160)</h2><p>In Section 2.3, the system versions are identified. It is observed thattwo <em>Windows 7</em> hosts, 172.20.1.70 and 172.20.50.160, are running theSMB service. A well-known critical vulnerability in Windows 7 SMB, knownas <strong>EternalBlue</strong> (CVE-2017-0144[1], MS17-010[2]), is exploited toattack these two target hosts.</p>
<h3 id="Vulnerabilities-Identification"><a href="#Vulnerabilities-Identification" class="headerlink" title="Vulnerabilities Identification"></a>Vulnerabilities Identification</h3><p>The auxiliary module <em>smb_ms17_010</em> in the Metasploit framework wasfirst used to detect whether host 172.20.1.70 is vulnerable to theEternalBlue vulnerability. The scan result shows ‘Host is likelyVULNERABLE to MS17-010’, indicating that this Windows 7 Enterprise hostmost likely does not have a patch for the Eternal Blue vulnerabilityinstalled, or is still using the flawed SMBv1 protocol.</p>
<p>After specifying the attack payload, the logs show that the module hasstarted sending specially crafted SMB packets and performing variousmemory operations to trigger an overflow in the SMBv1 stack. The payloadis injected into the memory of the target system, shown in Figure 3 leftimage.</p>
<p>If the exploit is successful, the attacker can gain access to the remoteshell and even take over the target host completely. However, in thisexperiment, no shell was obtained, the attack could not be launchedsuccessfully, command log shown in Figure 3 right image.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image5.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image6.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : EternalBlue exploitation in 172.20.1.70 by Metasploit(<a target="_blank" rel="noopener" href="https://www.metasploit.com/">https://www.metasploit.com</a>)</p>
<p>The presence of an active Meterpreter session in Figure 4 left indicatesthat the exploit has achieved remote code execution on the targetWindows 7 host. Even though a `RubySMB::Error::Communication-Error`can be seen, the fact that the session has been created and `sysinfo`is running successfully confirms that the exploit has at least partiallysucceeded in compromising the system. The getpid command in Figure 3right reveals the current process ID (e.g., 2272), confirming thatMeterpreter is attached to a privileged process. This level of accesseffectively grants the attacker complete control over the compromisedmachine.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image7.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image8.png" srcset="/img/loading.gif" lazyload class="">


<p>The network routes could be seen from the compromised host within aMeterpreter session in Figure 5 left, indicating which networks theinfected machine can access directly. Figure 5 right indicates the localARP (Address Resolution Protocol) cache. It provides IP-to-MAC addressmappings for devices recently communicated with by the compromised host.By examining these entries, attackers can discover other active systemson the network.</p>
 <img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image9.png" srcset="/img/loading.gif" lazyload class="">

 <img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image10.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure : Route and ARP information of 172.20.1.70 by Metasploit.</p>
<p>Here credentials are fetched from memory that include NTLM and SHA1hashes for various users in the ICS-LAB-OT domain, which can beexploited to attempt to pass hash attacks, impersonate users, or elevateprivileges within the domain in Figure 6.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image11.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image12.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : MSV Credentials of 172.20.1.70 by Metasploit.</p>
<p>It results list multiple network interfaces, including the SoftwareLoopback Interface 1 (with IPv4 address 127.0.0.1), several MicrosoftISATAP Adapters, and physical Ethernet connections in Figure 7. Inparticular, Figure 7 demonstrates that while the Meterpreter session wasestablished through the IP address 172.20.1.70, the same physicalWindows machine also holds an interface assigned to 172.20.50.160. Inother words, the host is multi-homed or configured with multiple networkadapters, each belonging to a different subnet. This configurationallows traffic to traverse between the 172.20.1.x and 172.20.50.xnetworks on the same device.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image13.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image14.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Ipconfig output of 172.20.1.70 by Metasploit.</p>
<p>Figure 8 demonstrates a successful hashdump command, extracting thelocal SAM database hashes from the compromised Windows machine. Thesehashes represent local accounts (e.g., Administrator, Guest, ICS-Admin)and can be cracked offline or reused in pass-the-hash scenarios.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image15.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Hashdump in 172.20.1.70 by Metasploit.</p>
<h3 id="Exploitation-Mitigations"><a href="#Exploitation-Mitigations" class="headerlink" title="Exploitation &amp; Mitigations"></a>Exploitation &amp; Mitigations</h3><p>To address these vulnerabilities, it is important that administratorspromptly deploy the latest security patches from Microsoft addressingthe MS17-010 issue. Given that Windows 7 is now deprecated, a transitionto a more modern operating system is strongly advised. Moreover,disabling SMBv1 is critical in order to remove the primary attack vectorexploited by EternalBlue.</p>
<p>Beyond patching and system upgrades, a comprehensive security strategyshould incorporate network segmentation to ensure that SMB traffic isconfined strictly to trusted zones. This should be complemented by theimplementation of robust firewall rules to minimize unnecessaryexposure. Routine vulnerability assessments and continuous monitoring ofnetwork traffic are also essential components, as they facilitate theearly detection of emerging threats and enable prompt remedial action.</p>
<h2 id="Camera-Password-Leaking-Main-Victim-172-20-1-30-9081"><a href="#Camera-Password-Leaking-Main-Victim-172-20-1-30-9081" class="headerlink" title="Camera Password Leaking (Main Victim: 172.20.1.30:9081)"></a>Camera Password Leaking (Main Victim: 172.20.1.30:9081)</h2><h3 id="Vulnerabilities-Identification-1"><a href="#Vulnerabilities-Identification-1" class="headerlink" title="Vulnerabilities Identification"></a>Vulnerabilities Identification</h3><p>The Nmap scan for host 172.20.1.30 reveals two distinct services onports 8765 and 9081. It suggests that the auxiliary interface on port8765 may be misconfigured or partially implemented, potentially exposinginternal error details. In contrast, when we access 172.20.1.30:9081directly via a browser, the website loads normally in Figure 9. Itobserved that the device displayed sensitive information such as livevideo feeds and configuration details including username and password ofone host, leading to potential privacy breaches and serving as a pivotfor further network attacks in Section 3.3.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image16.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Finding the stable video stream with the leaking password onPort 9081 for Host 172.20.1.30</p>
<h3 id="Exploitation-Mitigations-1"><a href="#Exploitation-Mitigations-1" class="headerlink" title="Exploitation &amp; Mitigations"></a>Exploitation &amp; Mitigations</h3><p>As it stands now, default credentials on devices such as cameras shouldbe replaced immediately with strong, unique authentication details,incorporating a mix of uppercase letters, lowercase letters, numbers,and special characters. Enabling HTTPS to secure communications betweenthe camera and its clients is strongly recommended to preventinterception of sensitive data. Network segmentation, strict firewallrules, or VPN-only access can further reduce exposure to unauthorizedusers. Finally, regular firmware updates and proactive monitoring ofaccess logs ensure that any anomalous activity is detected early andremediated swiftly, thereby maintaining a resilient security postureacross the entire infrastructure. And regular awareness sessions shouldreinforce that passwords must never be publicly displayed, and anysensitive login information should be stored in sealed envelopes kept inlocked cabinets or within secure password managers.</p>
<h2 id="PLC-HMI-Remote-Access-Control-Main-Victim-172-20-1-100"><a href="#PLC-HMI-Remote-Access-Control-Main-Victim-172-20-1-100" class="headerlink" title="PLC &amp; HMI Remote Access &amp; Control (Main Victim: 172.20.1.100)"></a>PLC &amp; HMI Remote Access &amp; Control (Main Victim: 172.20.1.100)</h2><p>From Section 3.2, the default account and password obtained from one ofthe [live site cameras (<strong>172.20.1.30:9081</strong>)]{.underline}:<em>engineer&#x2F;password123</em> allows direct login to [Windows 10 Workstation(<strong>172.20.1.100</strong>)]{.underline}, which can be used to fully control PLCand HMI in the filed site, shown in Figure 10.</p>
 <img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image17.png" srcset="/img/loading.gif" lazyload class="">

 <img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image18.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure : Remote login to Windows 10 Workstation (172.20.1.100) bydefault password. Left image is the workstation login page with thecorrect username and password. Right image is the desktop page ofworkstation with another username and password pair.</p>
<p>Another password can be found in the desktop, which can be used to loginthe TIA administrator app. By doing so, many automations appsinformation can be leaked. The interface displays three primaryfunctions: Manage licenses &amp; download software, Manage software, andCentral user management, like the Figure 11.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image19.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Successfully go into TIA Administrator Dashboard</p>
<p>It is easy to view the Siemens Automation License Manager and otherinstalled components such as TIA Portal V18, SIMATIC STEP 7 Safety anduser management functions on the ENG-WORKSTATION, shown in Figure 12.The interface provides options for searching for updates, installinglanguage packs and viewing individual software versions. Regularupdating of these tools ensures the compatibility, stability and safetyof industrial automation processes.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image20.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Overview of Installed Siemens software in workstation machine.</p>
<p>The projects are in the desktop, which can be opened by TIA, and canconnect to the PLC and HMI successfully. After entering Tank_PLC&#39;sproject and attempting Go online operation, by selecting the PN&#x2F;IE(Profinet) interface and verifying the target device, the CPU model isconfirmed to be an S7-1200 (CPU 1212C AC&#x2F;DC&#x2F;Rly) and the IP address is172.20.1.10, shown in Figure 13 left image. After reviewing the HMI&#39;soverview screen and properties in Figure 13 right image, it was alsoconfirmed that the device has an IP of 172.20.1.9, even though it is inthe initial or blank configuration stage.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image21.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image22.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure : TIA using &quot;Go online&quot; function connects to the PLC and HMIdevices. Left image represents that TIA in workstation can successfullysearch the PLC. The right image shows the HMI connected page.</p>
<p>Entering the User management settings window of the <em>S7-1200 PLC</em>, itwas found that attacker can change passwords for different access levelssuch as <em>‘Everybody’</em>, <em>‘admin’</em>, <em>‘Minimum’</em> or <em>‘Administrative’</em>,shown in Figure 14 left image. In general, by adjusting thesecredentials, security personnel can restrict access to control functionsor configuration parameters to unauthorized persons, thus improving thesecurity of the PLC. The Protection &amp; Security screen is where anattacker can configure access levels shown in Figure 14 right image andenable or disable security mechanisms such as block protection, HMIaccess restrictions, and more. If these parameters are modified, it islikely that the production process will be affected or threatened.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image23.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image24.png" srcset="/img/loading.gif" lazyload class="">



<p>Figure : TIA Permission configuration. The left image shows the attackercan reset the admin&#39;s password; the right image shows the access levelconfig in TIA, which allows full access.</p>
<p>Here, <strong>Connected Components Workbench</strong> shows the Micro850 controller’sgeneral settings in Figure 15. The vendor’s name is identified as**[Allen-Bradley]{.underline}**, and the controller project version isset to 1.0. This interface provides an overview of the PLC’s status andconfiguration, including details such as project name, firmware, andactive modules. Ensuring these parameters remain consistent and securehelps maintain reliable operation of the PLC. The Ethernet settings forthe Micro850 controller are shown in Figure 16. The user can enable ordisable DHCP, set a static IP (e.g., 172.20.1.x), and configure subnetmask, gateway, and inactivity timeouts. Properly assigning IP addressesand segregating the PLC from untrusted networks is crucial forminimizing unauthorized access in an ICS environment.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image25.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Genera configuration page for the Micro850 PLC.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image26.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Network port and IP address configuration for the Micro850 PLC.</p>
<p>Connected Components Workbench where a <strong>PV800 HMI</strong> project is open inFigure 17. The user can configure <strong>[Email Accountsettings]{.underline}</strong>, including SMTP server details, port 465, andpotential encryption TLS. Such a configuration is commonly used to sendalarm notifications or system alerts directly from the HMI. Properlysecuring these credentials is vital to prevent unauthorized users fromintercepting critical notifications or tampering with the email service.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image27.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : PV800 HMI Email account configuration page.</p>
<p>When attempting to connect to the Micro850, the user encounters a”Connection failed” prompt in Figure 18. This error can result frommismatched IP settings, firewall rules, or hardware availability issues.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image28.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Failed connection attempt with the Micro850 controller.</p>
<p>We also looked at the Windows start menu of the engineering workstation,with a variety of ICS-related software installed shown in Figure 19,such as Rockwell Automation tools, Siemens TIA Portal, and the LicenseManager. The co-existence of software from different vendors reflectsthe multi-platform scenario common in modern industrial environments.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image29.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : ICS Engineering workstation application list in &quot;start&quot; menu.</p>
<h2 id="Leaking-Remote-Desktop-Main-Victim-172-20-1-70"><a href="#Leaking-Remote-Desktop-Main-Victim-172-20-1-70" class="headerlink" title="Leaking Remote Desktop (Main Victim: 172.20.1.70)"></a>Leaking Remote Desktop (Main Victim: 172.20.1.70)</h2><h3 id="Vulnerabilities-Identification-2"><a href="#Vulnerabilities-Identification-2" class="headerlink" title="Vulnerabilities Identification"></a>Vulnerabilities Identification</h3><p>During our investigation, the host at 172.20.1.70 is running Windows 7Enterprise N Service Pack 1 and belongs to the ICS-LAB-OT domain. Theopen ports: 135&#x2F;tcp (MSRPC), 139&#x2F;tcp (NetBIOS-ssn), 445&#x2F;tcp (SMB), and3389&#x2F;tcp (RDP) are typical of a Windows environment, confirming thesystem’s role as a server or workstation within the ICS network. Andport 3389 is associated with Remote Desktop Services, so our subsequentconnection attempt revealed a login prompt labeled”KEPWARE-SERVER\engineer,” demonstrating that we could reach the RemoteDesktop Protocol (RDP) interface over the network, shown in Figure 20.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image30.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : RDP login screen for 172.20.1.70</p>
<h3 id="Exploitation-Mitigations-2"><a href="#Exploitation-Mitigations-2" class="headerlink" title="Exploitation &amp; Mitigations"></a>Exploitation &amp; Mitigations</h3><p>Administrators must secure RDP to prevent data exposure. Enable NetworkLevel Authentication (NLA) and high-grade encryption to prevent sessionhijacking. Restrict access using firewall rules or VPNs, allowing onlyapproved IPs. Enforce strong passwords and multi-factor authentication(MFA) for added security.</p>
<p>Continuously monitor RDP logs for suspicious activity using centralizedlogging and intrusion detection. Keep RDP software updated and considersecure alternatives. These measures safeguard remote access and preventdata leaks</p>
<h2 id="S7-1200-PLC-Station-Main-Victim-172-20-1-10"><a href="#S7-1200-PLC-Station-Main-Victim-172-20-1-10" class="headerlink" title="S7-1200 PLC Station (Main Victim: 172.20.1.10)"></a>S7-1200 PLC Station (Main Victim: 172.20.1.10)</h2><h3 id="Vulnerabilities-Identification-3"><a href="#Vulnerabilities-Identification-3" class="headerlink" title="Vulnerabilities Identification"></a>Vulnerabilities Identification</h3><p>Network scan of 172.20.1.10 reveals HTTP (port 80) and HTTPS (port 443)services labeled “Introduction” and “Siemens AG,” respectively. Thedevice’s interface displays details about a Siemens S7-1200 station,indicating this may be a portal for industrial control configuration inFigure 21. Despite the interface requesting a username and password, nocredential combination successfully grants access, suggesting eitherincorrect default credentials or a locked-down interface.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image31.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Login page of S7-1200 station, shows the login interface andthe basic information of S7-1200 station.</p>
<h3 id="Exploitation-Mitigations-3"><a href="#Exploitation-Mitigations-3" class="headerlink" title="Exploitation &amp; Mitigations"></a>Exploitation &amp; Mitigations</h3><p>Attempts to authenticate with default credentials failed, suggestingthey are either unused or blocked. Without a successful login, furtherexploitation was not possible.</p>
<p>Mitigation should go beyond patching and disabling defaults. If remoteaccess is unnecessary, isolate the control interface or place it on adedicated VLAN with strict filtering. If required, use a securitygateway or hop server for controlled access.</p>
<p>Minimize the attack surface by disabling non-essential services,applying vendor-provided updates, and conducting regular securityaudits. Ensure staff follows best practices for secure operations.</p>
<h2 id="SCADAROFT-10-150-20-100-8080-PHP-Page-10-150-20-100-8080-info-php"><a href="#SCADAROFT-10-150-20-100-8080-PHP-Page-10-150-20-100-8080-info-php" class="headerlink" title="SCADAROFT (10.150.20.100:8080) &amp; PHP Page (10.150.20.100:8080&#x2F;info.php)"></a>SCADAROFT (10.150.20.100:8080) &amp; PHP Page (10.150.20.100:8080&#x2F;info.php)</h2><h3 id="Vulnerabilities-Identification-4"><a href="#Vulnerabilities-Identification-4" class="headerlink" title="Vulnerabilities Identification"></a>Vulnerabilities Identification</h3><p>There is an Apache server running on port 8080, hosting a SCADA Croftapplication and a publicly accessible <em>index.php</em> page. By using pathtraversal tool to search the web page URL, an <em>info.php</em> page is alsofound. Figure 22 illustrates the result of path traversal by the tool of<em>gobuster</em>.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image32.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Path traversal to the victim website by gobuster(<a target="_blank" rel="noopener" href="https://github.com/OJ/gobuster">https://github.com/OJ/gobuster</a>)</p>
<p>The SCADA Croft interface displays real-time data for tank operationsshown in Figure 23 left image, including flow and level values, whilethe <em>info.php</em> file reveals detailed information about the PHPenvironment in Figure 23 right image. These phenomena indicate possiblesafety hazards.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image33.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image34.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure : The website pages in 10.150.100:8080. Left image is SCADA Croftdisplaying real-time tank status and operational parameters, while rightimage is PHP environment and configuration settings.</p>
<p>By opening the browser&#39;s built-in developer tools, additional files,including waterplant.php and factory.php, can be discovered, as shown inFigure 24.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image35.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image36.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image37.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure : The additional PHP files in SCADA dashboard.</p>
<h3 id="Exploitation-Mitigations-4"><a href="#Exploitation-Mitigations-4" class="headerlink" title="Exploitation &amp; Mitigations"></a>Exploitation &amp; Mitigations</h3><ol>
<li><p><strong>Restrict Access:</strong> Protect the SCADA interface with strong    authentication and place it behind a VPN or firewall rules to ensure    only authorized personnel can reach the application.</p>
</li>
<li><p><strong>Remove or Secure <em>info.php</em>:</strong> Limit or remove public access to    the <em>info.php</em> file, as it exposes sensitive system details. If    required for debugging, place it behind authentication or enable it    only in a controlled environment.</p>
</li>
<li><p><strong>Disable Open Proxy Functionality:</strong> Verify that the server is not    acting as a forward proxy unless explicitly needed. If proxy    features are required, implement strict access control lists and    logging to prevent abuse.</p>
</li>
<li><p><strong>Harden Apache &amp; PHP Settings:</strong> Disable unnecessary modules,    enforce secure configurations, and regularly update both Apache and    PHP to address known vulnerabilities.</p>
</li>
</ol>
<h2 id="PLC-Spoofing"><a href="#PLC-Spoofing" class="headerlink" title="PLC Spoofing"></a>PLC Spoofing</h2><h3 id="Vulnerabilities-Process"><a href="#Vulnerabilities-Process" class="headerlink" title="Vulnerabilities Process"></a>Vulnerabilities Process</h3><p>View the TIA Portal project named 1200 Tank_Level_V18 in Figure 25,focus on the PLC Tags view for the CPU 1212C AC&#x2F;DC&#x2F;Rly, which wereuseful in the next steps.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image38.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure 25: Path traversal to the victim website by gobuster(<a target="_blank" rel="noopener" href="https://github.com/OJ/gobuster">https://github.com/OJ/gobuster</a>)</p>
<p>In the Figure 26 left, the script read1.py has been prepared andexecuted several times, with each run displaying a Boolean result suchas ‘False’ or ‘True’ indicating the status of a specific bit in the PLCmemory, thus enabling real-time monitoring of changes. This indicatesthat the value of the bit will fluctuate depending on the internal logicof the PLC or the process conditions.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image39.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image40.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 26: read1.py Script Content &amp; Output</p>
<p>The script in the Figure 27 left uses the Snap7 library<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://pypi.org/project/python-snap7">[1]</span></a></sup>, by usingSnap7 in Python the user can programmatically change the discreteoutputs for testing or demonstration purposes, potentially simulating ortriggering events in a controlled process. In the terminal in the Figure27 right, although the console output itself is not visible, this meansthat the script has successfully connected to the PLC, written thespecified bit to `True`, and then disconnected.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image41.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image42.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 27: .py Script Content &amp; Output.</p>
<p>By manipulating the PLC, we can control the draining process of the water tank in an industrial control environment, potentially leading to an uncontrolled overflow of water in the tank.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/tank.png" srcset="/img/loading.gif" lazyload class="">


<h3 id="Exploitation-Mitigations-5"><a href="#Exploitation-Mitigations-5" class="headerlink" title="Exploitation &amp; Mitigations"></a>Exploitation &amp; Mitigations</h3><p>PLC spoofing occurs when an attacker impersonates a legitimate PLC orinjects false data into the communication channel, thereby misleadingoperators or higher-level systems. In an environment where protocolslike Snap7 or Modbus are used without robust authentication, an attackercan craft packets that mimic valid PLC responses. This approach mighttrick the HMI into displaying incorrect sensor readings, causeunauthorized actuation of outputs, or prevent real alarms from beingtriggered. Spoofing can also be combined with a denial-of-servicetactic, where the legitimate PLC is taken offline, leaving the maliciousnode as the sole data source.</p>
<p>The key to preventing PLC spoofing is the use of secure protocols andstrong authentication mechanisms. Whenever possible, industrialprotocols should support encryption and integrity checks so that data intransit cannot be tampered with or impersonated. Certificate-basedauthentication is also recommended, as it verifies both client andserver, thus reducing the likelihood of an attacker successfully posingas a legitimate device. Beyond secure protocols, network segmentationplays a critical role in limiting an intruder’s reach; isolating PLCs onrestricted subnets and configuring VLANs or strict firewall rulesensures that only authorized engineering workstations or SCADA serverscan communicate with critical control devices. In addition, devicewhitelisting and continuous network monitoring help identify unusualtraffic patterns or spoofed MAC&#x2F;IP pairs, thereby thwarting attempts atunauthorized access or command injection.</p>
<h2 id="Window-privilege-escalation"><a href="#Window-privilege-escalation" class="headerlink" title="Window privilege escalation"></a>Window privilege escalation</h2><h3 id="Vulnerabilities-Identification-5"><a href="#Vulnerabilities-Identification-5" class="headerlink" title="Vulnerabilities Identification"></a>Vulnerabilities Identification</h3><p>IP: 172.20.1.100 is win10 pro, we found that its version has localprivilege escalation vuln, which is CVE-2022-21882. We stop the windowsdefender first, and download the exp from github.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image43.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image44.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Stop defender and search the useful CVE from GitHub(<a target="_blank" rel="noopener" href="https://github.com/KaLendsi/CVE-2022-21882">https://github.com/KaLendsi/CVE-2022-21882</a>).</p>
<p>By leveraging this vuln, attacker can execute windows command with theSYSTEM privilege. We tried to add a admin user in the system in Figure29.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image45.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image46.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image47.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : Proof of getting system privilege and add account.</p>
<p>Then we add admin user into the administrators group in Figure 30.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image48.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image49.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure : proof of adding user into administrators group.</p>
<p>The process above shows that attacker can do anything in the machinewith the STSTEM privilege, which can lead a big problem in the whole OTsystem.</p>
<h3 id="Exploitation-Mitigations-6"><a href="#Exploitation-Mitigations-6" class="headerlink" title="Exploitation &amp; Mitigations"></a>Exploitation &amp; Mitigations</h3><p><strong>1. Keep system update:</strong> Ensure Windows and all installed software areup to date with the latest security patches to mitigate vulnerabilitiesthat allow privilege escalation.</p>
<p><strong>2. Install EDR in local machine:</strong> EDR can detect and response somemalicious actions, not just based on the signature.</p>
<h2 id="DNS-default-password"><a href="#DNS-default-password" class="headerlink" title="DNS default password"></a>DNS default password</h2><h3 id="Vulnerabilities-Identification-6"><a href="#Vulnerabilities-Identification-6" class="headerlink" title="Vulnerabilities Identification"></a>Vulnerabilities Identification</h3><p>IP: 172.20.1.1, which is gateway of the 172.20.1.0&#x2F;24, and it installsthe firewall system based on the information collection at thebeginning. We found that this firewall system panel uses the defaultpassword: admin&#x2F;pfsense, which can let attacker change any configurationin the panel.</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image50.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image51.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure 31: pfsense panel and proof of default account&amp;&amp;password</p>
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image52.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image53.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure 32: pfsense panel and proof of changing the configurations</p>
<h3 id="Exploitation-Mitigations-7"><a href="#Exploitation-Mitigations-7" class="headerlink" title="Exploitation &amp; Mitigations"></a>Exploitation &amp; Mitigations</h3><p><strong>1.Change Default Credentials Immediately：</strong> Upon initial setup, changethe default administrator username and password to a strong, uniquecombination.</p>
<p><strong>2. Use Strong Password Policies：</strong> Enforce complex passwords with atleast 12 characters, including uppercase and lowercase letters, numbers,and special characters.</p>
<p><strong>3. Implement Multi-Factor Authentication (MFA)：</strong> Require MFA forfirewall administrative access to add an extra layer of security beyondjust a password</p>
<p><strong>4.Use Role-Based Access Control (RBAC)：</strong> Assign different privilegelevels to users based on their job roles, ensuring that only authorizedpersonnel have administrative access.</p>
<h1 id="Indicator-of-Compromise"><a href="#Indicator-of-Compromise" class="headerlink" title="Indicator of Compromise"></a>Indicator of Compromise</h1><p>In an ICS environment, an Indicator of Compromise (IOC) is anysign—digital or physical—that suggests the network, or its deviceshave been breached or are actively under attack. Over the course ofthese assessments, several vulnerabilities were found, ranging fromWindows SMB exposures (EternalBlue) and public camera feeds tomisconfigured PLCs and posted credentials. Each of these vulnerabilitiescan generate specific signals that, if monitored correctly, will helpdetect malicious activity in its early stages.</p>
<h2 id="Publicly-displayed-credentials"><a href="#Publicly-displayed-credentials" class="headerlink" title="Publicly displayed credentials"></a>Publicly displayed credentials</h2><p>One of the most striking vulnerabilities we observed was the presence ofpublicly displayed credentials. If these credentials belong to anengineering workstation or any device with administrative privileges, itbecomes alarmingly easy for an attacker to gain remote access. The firstIOC here would be unexpected login attempts from unusual IP addresses orat odd hours on the engineering workstation. Since the password isopenly accessible, malicious actors need not rely on brute force; theycan simply use the known combination. Logs revealing successful loginsfrom IP ranges outside the facility’s typical geographic boundaries orfrom segments of the network that rarely communicate with theengineering workstation would be a major red flag. Additionally, iflegitimate users suddenly lose access or experience locked-out accounts,it may indicate that an attacker has hijacked those credentials andchanged passwords to maintain control.</p>
<h2 id="The-EternalBlue-MS17-010-Exploit"><a href="#The-EternalBlue-MS17-010-Exploit" class="headerlink" title="The EternalBlue (MS17-010) Exploit"></a>The EternalBlue (MS17-010) Exploit</h2><p>The EternalBlue (MS17-010) vulnerability was discovered on Windows 7hosts such as 172.20.1.70 and 172.20.50.160. Indicators of anEternalBlue compromise typically include unusual SMB traffic—forinstance, a spike in malformed SMB packets, or repeated connections toport 445 from internal hosts that normally do not communicate on thatport. Security logs might also reveal memory corruption or references toprocesses like “DoublePulsar” in advanced forensic traces. If anattacker has successfully exploited EternalBlue, subsequent IOCs couldinvolve the creation of unauthorized local accounts, the presence ofsuspicious services, or the system spawning remote shells outside normalusage patterns. By monitoring SMB logs and employing intrusion detectionsystems tailored to ICS networks, defenders can catch these anomaliesbefore the attacker can escalate privileges across the environment.</p>
<h2 id="Unauthorized-Surveillance"><a href="#Unauthorized-Surveillance" class="headerlink" title="Unauthorized Surveillance"></a>Unauthorized Surveillance</h2><p>Open or poorly protected camera feeds, such as the one observed at172.20.1.30:9081, present a risk of unauthorized surveillance. Repeatedattempts to access or stream from the camera feed—particularly fromunknown IP addresses or during non-standard operational hours—serve asstrong indicators of compromise. System logs that record multiple HTTP401 (Unauthorized) or 403 (Forbidden) responses may point to brute-forceor reconnaissance activities targeting the camera interface.Furthermore, if the logs show successful logins that cannot be matchedwith known users or if access originates from IPs not associated withauthorized personnel, this strongly suggests that the camera feed isvulnerable and may be compromised. Immediate attention to securing thesefeeds is necessary to prevent unauthorized data access and potentialprivacy breaches.</p>
<h2 id="The-PLC-and-HMI-Misconfigurations"><a href="#The-PLC-and-HMI-Misconfigurations" class="headerlink" title="The PLC and HMI Misconfigurations"></a>The PLC and HMI Misconfigurations</h2><p>Misconfigurations in PLC and HMI settings, particularly within the TIAPortal environment for S7-1200 controllers, pose significant securityrisks. Any unexpected changes to project files, user managementconfigurations, or protection settings should be considered a potentialindicator of unauthorized modifications. Unapproved alterations in PLClogic or sudden shifts in user account access levels, such as an”Everybody” group gaining write privileges, may indicate that anattacker is attempting to compromise the device. Additionally, recurrent”Connection failed” messages in system logs could suggest attempts toguess or override PLC credentials. In environments where auto-updates orremote management are enabled, unplanned reboots or firmware updates mayalso signal covert tampering. It is essential to implement stringentaccess controls and continuous monitoring to promptly detect andremediate these risks.</p>
<p>Overall, an effective IOC strategy must tie each recognizedvulnerability to specific red flags in network traffic, logs, orphysical environment changes. By diligently monitoring foranomalies—whether they manifest as repeated SMB connections,unauthorized HMI logins, or suspicious updates to PLCfirmware—security teams can detect intrusions swiftly and minimizedamage. Employing robust logging, strict authentication policies, andcontinuous staff training amplifies these efforts. Only by maintainingawareness of the potential compromise signs, consistently analyzinglogs, and understanding normal operational baselines can ICS operators’thwart threats in real time. The ultimate goal is to transform everydiscovered vulnerability into a well-defined set of IOCs that, oncetriggered, sets off an immediate and decisive security response.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>This experiment report provides a comprehensive assessment of thesecurity posture within a simulated ICS environment. Over the course ofthe two-day exercise, a variety of tools—including Nmap andMetasploit—were utilized to map network assets, identifyvulnerabilities, and attempt exploitation. The analysis revealed severalcritical issues that demand immediate attention.</p>
<h1 id="REFERENCES"><a href="#REFERENCES" class="headerlink" title="REFERENCES"></a>REFERENCES</h1><p>[1] CVE-2017-0144 : the SMBv1 server in Microsoft windows vista SP2;windows server 2008 SP2 and R2: 2017.<em><a target="_blank" rel="noopener" href="https://www.cvedetails.com/cve/CVE-2017-0144/">https://www.cvedetails.com/cve/CVE-2017-0144/</a></em>. Accessed: 2025-03-14.</p>
<p>[2] Microsoft security bulletin MS17-010 - critical: 2023.<em><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010">https://learn.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010</a></em>.Accessed: 2025-03-14.</p>
<p>[3] Rekhter, Y. et al. 1996. <em>RFC1918: address allocation for privateinternets</em>. RFC Editor.</p>
<h2 id="Appendices"><a href="#Appendices" class="headerlink" title="Appendices"></a>Appendices</h2><img src="/2025/07/02/Penetration-testing-of-industrial-control-systems/image54.png" srcset="/img/loading.gif" lazyload class="">

<section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a target="_blank" rel="noopener" href="https://pypi.org/project/python-snap7">https://pypi.org/project/python-snap7</a>
<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%B7%A5%E6%8E%A7%E5%AE%89%E5%85%A8/" class="print-no-link">#工控安全</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Penetration testing of Industrial Control Systems(ICS)</div>
      <div>http://k0rz3n.com/2025/07/02/Penetration-testing-of-industrial-control-systems/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>K0rz3n</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>July 2, 2025</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - Non-commercial">
                    <i class="iconfont icon-cc-nc"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - Share-alike">
                    <i class="iconfont icon-cc-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/07/05/Penetration-testing-in-IOT-environment/" title="Penetration testing in industrial IOT environment">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Penetration testing in industrial IOT environment</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/06/20/Cridex-Trojan-Infection-System-Forensic-Analysis/" title="Cridex Trojan Infection System Forensic Analysis Report">
                        <span class="hidden-mobile">Cridex Trojan Infection System Forensic Analysis Report</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
