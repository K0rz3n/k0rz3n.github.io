

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon/warning.png">
  <link rel="icon" href="/img/icon/warning.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="K0rz3n">
  <meta name="keywords" content="">
  
    <meta name="description" content="IntroductionThis report aims to explore and identify vulnerabilities within the network environment through penetration testing techniques. We conducted service discovery, targeted attacks on security">
<meta property="og:type" content="article">
<meta property="og:title" content="Penetration testing in industrial IOT environment">
<meta property="og:url" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/index.html">
<meta property="og:site_name" content="K0rz3n&#39;s Blog">
<meta property="og:description" content="IntroductionThis report aims to explore and identify vulnerabilities within the network environment through penetration testing techniques. We conducted service discovery, targeted attacks on security">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image1.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image2.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image3.jpg">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image4.jpg">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image6.jpg">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/table1.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/table1-1.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/table2.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image7.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image8.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image9.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image10.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image11.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image12.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image12.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image13.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image14.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image15.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image16.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image17.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image19.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image21.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image22.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image24.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image26.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image27.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image28.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image29.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image30.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image31.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image33.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image34.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image35.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image36.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image37.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image38.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image39.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image40.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image41.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image42.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image43.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image44.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image46.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image47.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image48.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image49.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image50.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image52.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image53.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image54.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image55.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image56.jpeg">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image59.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image60.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image61.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image62.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image64.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image66.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image67.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image68.png">
<meta property="og:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image69.png">
<meta property="article:published_time" content="2025-07-05T09:10:40.000Z">
<meta property="article:modified_time" content="2025-08-20T18:16:29.624Z">
<meta property="article:author" content="K0rz3n">
<meta property="article:tag" content="IOT安全 工控安全">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/image1.png">
  
  
  
  <title>Penetration testing in industrial IOT environment - K0rz3n&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/macpanel.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"k0rz3n.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 60vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>K0rz3n&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/banner/icemountain.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Penetration testing in industrial IOT environment"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-07-05 10:10" pubdate>
          July 5, 2025 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.1k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          10 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Penetration testing in industrial IOT environment</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This report aims to explore and identify vulnerabilities within the network environment through penetration testing techniques. We conducted service discovery, targeted attacks on security risks unique to different devices, employing a variety of technical methods including traffic proxy technology, using jump machines to access the internal network, reverse engineering to analyze device configurations, sniffing network traffic, key cracking, and unauthorized vulnerability exploitation. We documented and analyzed the issues discovered to illustrate the real-world impact of security vulnerabilities in industrial and connected devices. The report was collaboratively completed by our team, with me primarily responsible for the penetration testing portion, while other members contributed to part of the penetration testing and report writing.</p>
<h1 id="Asset-Inventory"><a href="#Asset-Inventory" class="headerlink" title="Asset Inventory"></a>Asset Inventory</h1><h2 id="Environment-Setup"><a href="#Environment-Setup" class="headerlink" title="Environment Setup"></a>Environment Setup</h2><p>The first step to access the IoT devices subnet, is to setup one kalivirtual machine and connect to the access point in 192.168.88.1. Thekali bridge connects to the windows host and manually points to thewireless network interface.</p>
<h2 id="Identifying-Active-Hosts"><a href="#Identifying-Active-Hosts" class="headerlink" title="Identifying Active Hosts"></a>Identifying Active Hosts</h2><p>Using nmap scan the active host in subnet 192.168.88.0&#x2F;24 with followingcommand.</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">sudo</span> nmap -PR -sn <span class="hljs-number">192.168.88.0</span>/<span class="hljs-number">24</span><br></code></pre></td></tr></table></figure>


<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image1.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image2.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 1: nmap discovery active host</p>
<p>Figure 1 illustrates the scan results, including some wirelesslyconnected attacker devices (Windows and Kali) within the subnet, whichwill be excluded from following service analysis after checking.</p>
<h2 id="Service-Discovery"><a href="#Service-Discovery" class="headerlink" title="Service Discovery"></a>Service Discovery</h2><p>Based on the host addresses identified in Section 2.2, the next stepinvolves enumerate services running on each host. The [-A]option of <em>nmap</em> is utilized for aggressive scanning, including OSdetection, version detection, traceroute, etc.; the [-sV]option enables service version detection, and [-p-] optionidentifies all available ports. The result for important host is shownin Figure 2, Figure 3, Figure 4.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image3.jpg" srcset="/img/loading.gif" lazyload class="">


<p>Figure 2: Scanning result of host 192.168.88.254, which is recognized asthe Philip desk lamp.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image4.jpg" srcset="/img/loading.gif" lazyload class="">


<p>Figure 3: Scanning result of host 192.168.88.188, shown as Philips Hue.</p>
<p>In Figure 4, the identified services are totally same for the192.168.88.50 (left) and 192.168.88.189 (right). At the Section 3.2, itshows two Ip addresses is occupied by one machine.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image6.jpg" srcset="/img/loading.gif" lazyload class="">

<p>Figure 4: Scanning result of 192.168.88.50 &amp; 192.168.88.189, which lookssimilar that running same services.</p>
<p>The tables below provide a complete inventory of all active devicesidentified on two distinct network segments during the reconnaissancephase. Table 1 summarizes assets discovered on the primary managementsubnet (192.168.88.0&#x2F;24) via an Nmap ping sweep, listing each host’s IPaddress, open ports, and running services. This baseline inventoryestablishes visibility into core infrastructure components and informssubsequent vulnerability analysis.</p>
<p>Table 1: Active services in subnet 192.168.88.0&#x2F;24.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/table1.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/07/05/Penetration-testing-in-IOT-environment/table1-1.png" srcset="/img/loading.gif" lazyload class="">


<p>Table 2 captures assets on the secondary plant subnet([192.168.2.0&#x2F;24]), discovered by pivoting through thecompromised host at [192.168.88.186]. It follows the sameformat—IP, MAC&#x2F;vendor, exposed ports, and service details—to enablea consistent comparison of risk across both network segments and supportprioritized remediation planning.</p>
<p>Table 2: Active services in subnet 192.168.2.0&#x2F;24</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/table2.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image7.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 5: Network and communication structure in System</p>
<p>The above Figure 5 shows the network and communication structure in thewhole system that we analyze. The Simems 2050 is the key device thatconnects to subnet (192.168.88.0&#x2F;24 and 192.168.2.0&#x2F;24), which isrunning the Mosquitto broker service, receiving MQTTT messages fromZigbee receiver who collects meter values from sensor. Besides, Simems2050 is also running Node-RED, which collects information from ICSdevices (PLC and HMI) and sensor values. These values will be sent toSCADA Monitor, showing on the panel. Additionally, there are many homessmart devices, which connect to hubs using Zigbee protocol. Users canuse the phone connecting to cloud server on the internet to sendcommands to and get responses from the hubs to control these devices(Light, button and sensor).</p>
<p>The Nmap scan identified port 5000 on host 192.168.88.150 running a webinterface via upnp protocol in Figure 6, enabling direct browser accessto the Smart Plant Monitoring system, revealing connected PLC and HMIdevices and real-time operational status.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image8.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 6: Simulate SCADA monitor web page in Ubuntu 192.168.88.150.</p>
<p>Access to port 2050 on 192.168.88.50 requires no credentials shown inFigure 7 — the AV Embedded Configuration interface is exposed andpermits full administrative control without login.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image9.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 7: SIEMENS SIMATIC IoT2050 control panel in host192.168.88.50:2050.</p>
<p>In Figure 8, the Node-RED interface on 192.168.88.189:1880 is accessiblewithout authentication and reveals active logic flows for processingsensor data such as temperature, humidity, and conveyor status throughHTTP requests.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image10.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 8: Red-node web page in host 192.168.88.189:1880, shows theconnection logic of IoT devices. Which is also available in host192.168.88.50:1880.</p>
<p>Schematic diagram for accessing 192.168.2.10 and viewing the status andconfiguration information of Siemens S7-1200 station_2 | PLC_1 via aweb browser.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image11.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 9: Web‑based management interface of the Siemens SIMATIC S7‑1200PLC (CPU 1212C) reachable at [<a target="_blank" rel="noopener" href="https://192.168.2.10/Portal]">https://192.168.2.10/Portal]</a></p>
<h1 id="Survey-of-Plant-Monitoring-System"><a href="#Survey-of-Plant-Monitoring-System" class="headerlink" title="Survey of Plant Monitoring System"></a>Survey of Plant Monitoring System</h1><h2 id="Access-Point-Default-Password-Weak-Access-Control-Main-Victim-192-168-88-1"><a href="#Access-Point-Default-Password-Weak-Access-Control-Main-Victim-192-168-88-1" class="headerlink" title="Access Point Default Password &amp; Weak Access Control (Main Victim: 192.168.88.1)"></a>Access Point Default Password &amp; Weak Access Control (Main Victim: 192.168.88.1)</h2><p>An unauthenticated access vulnerability was identified in the RouterOSweb interface at [192.168.88.1], which exposes the fullswitch configuration menu, allowing an attacker to modify core networkinfrastructure without valid credentials, shown in<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image12.png" srcset="/img/loading.gif" lazyload class=""></p>
<p>Figure 10.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image12.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 10: Unauthenticated access to the RouterOS web interfaceat [192.168.88.1]</p>
<p>This is a typical misconfiguration issue; leaving critical networkinfrastructure such as access points and routers without passwords orprotected by weak credentials represents a significant security risk.This vulnerability includes multiple threat categories, including<strong>Tampering</strong>, <strong>Repudiation</strong>, and <strong>Information Disclosure</strong>.</p>
<h3 id="Mitigations"><a href="#Mitigations" class="headerlink" title="Mitigations"></a>Mitigations</h3><p>This issue can be significantly mitigated through stricter credentialmanagement mechanisms, such as enforcing strong passwords andimplementing multi-factor authentication (MFA). Additionally,controlling access via trusted IP allowlists, maintaining comprehensiveaccess logs, and regularly updating firmware and software are effectivemeasures to reduce risks associated with misconfigurations.</p>
<h2 id="Default-Password-Pair-Reverse-Shell-Establishment-Main-Victim-192-168-88-50"><a href="#Default-Password-Pair-Reverse-Shell-Establishment-Main-Victim-192-168-88-50" class="headerlink" title="Default Password Pair &amp; Reverse Shell Establishment (Main Victim: 192.168.88.50)"></a>Default Password Pair &amp; Reverse Shell Establishment (Main Victim: 192.168.88.50)</h2><p>In this section, the attacker remotely ssh connected to the SiemensIoT2050 device ([192.168.88.50]) using default credentialsand executed a trojanized program. Next, a listener was configured onthe Kali machine, along with auto routing and proxy services, therebyestablishing a reverse shell and a proxy server to achieve remote codeexecution (RCE) on the victim machine. Finally, Kali exploited<em>proxychains</em> to connect through the established proxy, enabling accessto the target network segment (192.168.2.0&#x2F;24).</p>
<h3 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h3><p>The host at [192.168.88.50] (Siemens IoT2050) was identifiedto be using default credentials, allowing SSH connection via the knowndefault password, shown in Figure 11.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image13.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 11: Remote connection to Siemens IoT2050 by SSH and defaultusername password pair.</p>
<p>To facilitate pivoting into the secondary network [192.168.2.0&#x2F;24)], a payload was generated by*[msfvenom]*<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[https://www.kali.org/tools/metasploit-framework/#msfvenom](https://www.kali.org/tools/metasploit-framework/%23msfvenom)">[1]</span></a></sup> to establish shell access on the targethost shown in Figure 12. By this step, one reverse shell is obtained forfollowing exploitation.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image14.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image15.png" srcset="/img/loading.gif" lazyload class="">



<p>Figure 12: Payload generation and transfer to remote host(192.168.88.50) by <em>scp</em> command. The upper image used for payloadgeneration, while lower image transfer the payload by scp with anestablished ssh channel.</p>
<p>After the payload subsequently uploaded, and necessary privilegeescalation was performed to gain full access in Figure 13, otherwise thepayload would have no permission to run in victim machine.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image16.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 13: <strong>Elevation of privilege</strong> to payload, allowed payloadrunning in target system.</p>
<p>Then, Metasploit framework (MSF) was used to establish a listener,configure routing, and set up a proxy to facilitate further networkaccess.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image17.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 14: The reverse TCP listener configuration involves three primarysteps: 1. initializing the handler with the specified local address andport, 2. configuring autorouting, and 3. finally launching a SOCKS proxyserver.</p>
<p>After successfully obtaining shell access to the host in Figure 15, inFigure 16, utilizing the system command to analyze the networkcommunication in victim, while another network segment was identifiedin.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image19.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 15 Launching Metasploit framework and setting up a Reverse TCPListener using an remote control(RC) Script.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image21.png" srcset="/img/loading.gif" lazyload class="">
<p>Figure 16: Network interface information leaking. The upper imageillustrates the result of <em>[sysinfo]</em> command execution. Andthe secondary subnet [192.168.2.0&#x2F;24] found in interface 3at lower image.</p>
<p>By configuring a local proxy running at [127.0.0.1:8080]through editing [proxychains.conf] in Figure 17 left image,nmap scans were conducted on this new segment in Figure 17 right image,revealing active hosts: [192.168.2.9],[192.168.2.10], and [192.168.2.130 (found in furtherscanning)].</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image22.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure 17: By fixing the proxy config in[&#x2F;etc&#x2F;proxychains.conf] like left image, successfullyexecute nmap command in [192.168.2.0&#x2F;24] subnet byproxychains.</p>
<p>After connecting to [192.168.88.189] using ssh, it’s easy tosee that [192.168.88.50&#x2F;24] and[192.168.88.189&#x2F;24] are both under eno2.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image24.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 18: Remote connection to 192.168.88.189. By using command ip a,represents that 192.168.88.50 and 192.168.88.189 is the one machine withdifferent ip address.</p>
<h3 id="Mitigations-1"><a href="#Mitigations-1" class="headerlink" title="Mitigations"></a>Mitigations</h3><p>Trojan implantation and reverse shell exploitation constitute highlycritical attack vectors. Exploiting RCE vulnerabilities enablesattackers to seize device control, embed hidden backdoors [5], andbotnets [1], among other malicious objectives. Such attacks implicateall six dimensions within the STRIDE threat analysis model.</p>
<p>To mitigate risks highlighted, implementing strong authenticationmethods such as key-based SSH authentication instead of passwords canreduce unauthorized access risks. Proper authorization rules must beenforced to limit user privileges strictly according to their roles.Secondly, unnecessary services and open ports that might disclosesensitive network information should be disabled or hidden to minimizepotential attack surfaces. Additionally, configuring firewall rules toallow only necessary connections and conducting regular software updatescan protect the system from known vulnerabilities, thus significantlyreducing risks of unauthorized access and information disclosure.Moreover, monitoring and alerting suspicious processes and networkconnections through Intrusion Detection Systems (IDS) will also play arole for defense malicious program operation.</p>
<h2 id="Unauthorized-RESTful-API-allows-Spoofing-of-the-desk-lamp-signal-Victim-192-168-88-188"><a href="#Unauthorized-RESTful-API-allows-Spoofing-of-the-desk-lamp-signal-Victim-192-168-88-188" class="headerlink" title="Unauthorized RESTful API allows Spoofing of the desk lamp signal (Victim: 192.168.88.188)"></a>Unauthorized RESTful API allows Spoofing of the desk lamp signal (Victim: 192.168.88.188)</h2><h3 id="Exploitation-1"><a href="#Exploitation-1" class="headerlink" title="Exploitation"></a>Exploitation</h3><p>A debugger page was accessible at<a target="_blank" rel="noopener" href="http://192.168.88.188/debug/clip.html">http://192.168.88.188/debug/clip.html</a>, so 192.168.88.188 wasidentified as an unauthenticated interface capable of controlling thesmart light in the left image of Figure 19. Activating the “Hug” buttonissued a request to the &#x2F;api endpoint shown in the right image of Figure19, which returned the session token:</p>
<p>mJmYjtqYzB4GpX6LewQ6bN067pnxetiVatbO0lVc</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image26.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure 19 The left image shows the website page of CLIP API Debugger on[192.168.88.188;\the right image is] using the CLIP API Debugger interface tosend HTTP requests</p>
<p>Querying URL path &#x2F;api&#x2F;mJmYjtqYzB4GpX6LewQ6bN067pnxetiVatbO0lVc&#x2F;revealed a light identifier of ‘1’, which is the light object responsewith detail status information from server.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image27.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 20 Retrieving device state information via the CLIP API Debugger</p>
<p>After that, a GET request to this resource confirmed the current stateof the light, and sending a PUT request to the same endpointsuccessfully updated its state to “on”, while the physical lamp alsoturned on.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image28.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image29.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 21: Clip API request attack.</p>
<h3 id="Mitigations-2"><a href="#Mitigations-2" class="headerlink" title="Mitigations"></a>Mitigations</h3><p>It was found that unauthorized users could access the RESTful APIinterface and remotely control the smart lighting due to the lack ofproper authentication mechanisms. Therefore, it’s critical to implementrobust authentication and authorization practices, such as deployingsecure API keys, OAuth tokens, or JSON Web Tokens (JWT). These methodsensure that only authorized entities can access sensitive API endpoints,effectively preventing unauthorized remote control of the lightingsystem as observed during our hands-on assessment.</p>
<p>Additionally, utilizing HTTPS instead of HTTP ensures that requestsremain encrypted during transmission, thereby mitigating the risk ofcredentials being intercepted by unauthorized third parties [7].Furthermore, restricting access to administrative functions throughtrusted device allowlists can further enhance the security posture.</p>
<h2 id="Reverse-Engineer-Find-Camera-Password-Main-Victim-192-168-88-20"><a href="#Reverse-Engineer-Find-Camera-Password-Main-Victim-192-168-88-20" class="headerlink" title="Reverse Engineer Find Camera Password (Main Victim: 192.168.88.20)"></a>Reverse Engineer Find Camera Password (Main Victim: 192.168.88.20)</h2><p>In this section, reverse engineering is used to decompile and analyzethe target APK package to extract sensitive information (e.g., usernamesand passwords) embedded in the software. Not only was the applicationsuccessfully executed using an Android emulator, but an unauthenticatedwebcam service interface was also discovered. It also discoveredusernames and passwords of administrators and regular users fromconfiguration files and APK package files respectively and successfullyaccessed the protected service from the web side.</p>
<h3 id="Exploitation-2"><a href="#Exploitation-2" class="headerlink" title="Exploitation"></a>Exploitation</h3><p>Firstly, find the camera tag and port from the imported APK packagewithin Jadx.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image30.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 22: Application name and label in AndroidManifest.xml file,extract from apk package by jadx<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="Java decompiler tool, ">[2]</span></a></sup>.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image31.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 23: Discovery the camera service port (8765 or 8081) by keywordsearching.</p>
<p>Figure 24 (left) shows the using of Android Studio and set the config ofcamera and retrieved credentials: URL(<a target="_blank" rel="noopener" href="http://192.168.88.20/">http://192.168.88.20</a>), label(PlantEye), port(8765), ensuring a successful connection to the camera feed.After the setup, a live feed can be viewed from the Raspberry Pi camerain Figure 24 (right).</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image33.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 24 Configuring and accessing a Raspberry Pi-based motionEyecamera via a mobile app</p>
<p>Regarding the connection to the web side, this can be done by firstconnecting to [192.168.88.20] using ssh with the defaultpassword in Figure 25.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image34.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 25 Locating and identifying potentially sensitive configurationfiles within a Raspberry Pi camera system</p>
<p>Once this process has gained permission, it is possible to locate theMotionEye configuration file and look for the administrator username andpassword directly from the relevant file.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image35.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 26: Ending the motion.conf configuration file and revealing admincredentials</p>
<p>Fill in the admin_username and admin_password in the browser login boxto successfully access the camera web interface.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image36.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 27 Logging into the Raspberry Pi camera web interface withadmin’s retrieved credentials</p>
<p>By using the Jadx software again, the app_debug.apk file was importedand the lookup keyword was set to the default username. As a result, thestrings.xml file of the Android application exposes the hard-codeddefault username (‘user’) and password (‘GoPr0NoGo.1337’).</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image37.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 28 Identifying hardcoded default credentials in an Android app’sresource file</p>
<p>Using the discovered credentials, the user successfully logs into a webinterface streaming from a Raspberry Pi camera.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image38.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 29 Logging into the Raspberry Pi camera web interface with user’sretrieved credentials</p>
<h3 id="Mitigations-3"><a href="#Mitigations-3" class="headerlink" title="Mitigations"></a>Mitigations</h3><p>To mitigate the risk identified, particularly the exposure of camerapasswords through reverse engineering of the application, more targetedsecurity practices should be applied. Specifically, sensitiveinformation such as login credentials and device access passwords shouldnever be hard-coded or plainly embedded within application binaries.Instead, these sensitive details should always be securely encrypted andstored in dedicated secure storage spaces.</p>
<p>Additionally, employing advanced obfuscation methods such as controlflow flattening, identifier renaming, and string encryption will obscurethe logical structure of the app, making it difficult and time-consumingfor potential attackers to locate and extract sensitive information. Andregular security assessments and updating the application’s obfuscationtechniques can consistently counter evolving reverse engineeringmethods, further protecting the system from unauthorized dataextraction.</p>
<p>Strengthening overall communication security is also critical.Implementing secure and encrypted protocols such as HTTPS withappropriate TLS certificates ensures that sensitive data transmittedbetween the application and its backend cannot be intercepted ortampered with during transit.</p>
<h2 id="Mosquitto-Sniffing-Victim-192-168-88-150"><a href="#Mosquitto-Sniffing-Victim-192-168-88-150" class="headerlink" title="Mosquitto Sniffing (Victim: 192.168.88.150)"></a>Mosquitto Sniffing (Victim: 192.168.88.150)</h2><h3 id="Exploitation-3"><a href="#Exploitation-3" class="headerlink" title="Exploitation"></a>Exploitation</h3><p>After connecting to 192.168.88.150 by SSH, it demonstrates the runningMosquitto broker process on the device (iot2050-debian) and a client.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image39.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 30 Checking running Mosquitto broker processes on the IoT2050host reveals an active MQTT subscription command, showing configurationdetails and topic subscriptions</p>
<p>In Figure 31, it uses the netstat -tupln command to check the servicesthat are running and listening for connections on the server.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image40.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 31 Checking active listening services, and result shows a varietyof ports and protocols, confirming that the Python-based service islistening on port 5000</p>
<p>Figure 32 displays the results from checking Mosquitto configurationfiles, identifying two active configuration files: one localconfiguration and one system-wide configuration.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image41.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 32 Results of checking Mosquitto configurations on the device</p>
<p>The contents of the system-wide Mosquitto configuration file show thepersistence setting and its designated location for storing persistentdata.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image42.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 33 Viewing contents of the Mosquitto system configuration file</p>
<p>The configuration file reveals that anonymous access is permitted onport 1883, indicating that any client can subscribe to or publishmessages without authentication.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image43.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 34 Local Mosquitto configuration permitting anonymous access</p>
<p>A Python MQTT client, hosted on IP 192.168.88.143, subscribes to allavailable MQTT topics.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image44.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 35 MQTT client at 192.168.88.143 subscribing to all MQTT topicsfrom the Mosquitto broker</p>
<p>Here it checks all the messages, indicating active connections andclient communications involving devices between 192.168.2.130 and192.168.2.50.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image46.png" srcset="/img/loading.gif" lazyload class="">
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image47.png" srcset="/img/loading.gif" lazyload class="">




<p>Figure 36 Analysis of Mosquitto broker logs</p>
<p>Figure 37 illustrates a Node-RED instance on 192.168.88.50, subscribingto the MQTT topic ip, verifying that device 192.168.2.130 operates as aZigBeeReceiver.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image48.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 37 Node-RED instance (192.168.88.50)</p>
<h3 id="Mitigations-4"><a href="#Mitigations-4" class="headerlink" title="Mitigations"></a>Mitigations</h3><p>Based on the observations and analysis from the practical experiment,the primary security issue arises from Mosquitto’s current configurationpermitting anonymous access on port 1883. This allows any device withinthe network, including unauthorized entities, to connect, subscribe, andpublish messages freely. To address this specific vulnerability,Mosquitto’s configuration must be modified to disable anonymous accessexplicitly. Implementing mandatory username and password authenticationthrough encrypted credential storage or external authentication serviceswould restrict broker access exclusively to authorized and verifieddevices.</p>
<p>Moreover, considering the nature of the practical operations,implementing secure communication channels is essential. Enabling TLSprovides robust encryption for messages exchanged between Mosquittobrokers and clients, ensuring confidentiality and integrity duringtransmission. And practical security enhancement also requires clearlydefined Access Control Lists (ACLs). Based on the report, it shouldexplicitly specify permissions for different clients, determining whichtopics they can publish or subscribe to. By enforcing strict topic-basedaccess policies tailored to industrial IoT environment, it could reducethe attack surface, limiting the risk of unauthorized access ormalicious control over the system.</p>
<h2 id="S7comm-Protocol-Non-authentication-Main-Victim-192-168-2-10"><a href="#S7comm-Protocol-Non-authentication-Main-Victim-192-168-2-10" class="headerlink" title="S7comm Protocol Non-authentication (Main Victim: 192.168.2.10)"></a>S7comm Protocol Non-authentication (Main Victim: 192.168.2.10)</h2><p>The [192.168.2.10] (Siemens PLC) communicates with other IoTdevices through S7comm protocol, which has been reported to containvulnerabilities that leak authentication mechanisms [2, 4]. Thissection leverages the identified vulnerability in the <em>S7Comm</em> protocolto handle a <strong>spoofing attack</strong> against the PLC. Based on the previouslyobtained reverse shell access to the host at [192.168.88.50](Siemens IoT2050), memory reading operations are performed on the victimto capture real-time states and analyze pin functionalities.Subsequently, a script continuously transmits crafted signals tospecific pins, overwriting legitimate signal content to achieve theintended spoofing effect.</p>
<h3 id="Exploitation-4"><a href="#Exploitation-4" class="headerlink" title="Exploitation"></a>Exploitation</h3><p>Since the reverse shell of [192.168.88.50] was obtained inSection 3.2, the attacker can read the PLC output signal through thescript shown in Figure 38. This script establishes a connection to thePLC, reads one byte from Q (Output) pin memory at address 0, and printsthe state of the specified bit ([%Q0.2],[%Q0.3]).</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image49.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 38 Python script using the Snap7 library to connect to theSiemens S7‑1200 PLC at [192.168.2.10] and read the Booleanvalue of bit 3 in the Q output memory area.</p>
<p>It runs through <em>proxychains</em>, indicating that remote memory reads canbe performed through the pivot network path without direct networkaccess (Figure 39).</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image50.png" srcset="/img/loading.gif" lazyload class="">

<p>Figure 39: Proxychains output confirming that the same Snap7 readoperation ([%Q0.2] in left, %[Q0.3] in right)successfully executed.</p>
<p>Experimental testing confirmed that pin [%I10.2], designatedas an input pin, could be successfully written to and read with thetampered value. The following reading loop script in Figure 40 wasutilized to retrieve the value from pin [%I10.2], while theresult of reading pin [%I10.2] is <em>True</em>, shown in Figure41.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image52.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 40: The reading loop scripts, using python snap7 library.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image53.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 41: The terminal result of reading [%I10.2] pin withthe proxy connection.</p>
<p>Figure 42 shows write script, which rewrite it to <em>false</em> in[%I10.2] at Siemens PLC([192.168.2.10)].</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image54.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 42: Rewrite python script to PLC. Tampering the true value in%I10.2 to false.</p>
<p>After executing write script, it can be observed that value wassuccessfully changed in Figure 43, the spoofing completed.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image55.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 43: Result changed in %I10.2 pin was observed.</p>
<h3 id="Mitigations-5"><a href="#Mitigations-5" class="headerlink" title="Mitigations"></a>Mitigations</h3><p>By implementing network segmentation, the PLC can be physically orlogically isolated from untrusted networks. Access control should beenforced based on the principle of least privilege, limiting access to apredefined list of authorized devices and operations. This approachsignificantly enhances PLC security by preventing unauthorizedinteractions. However, in the current scenario, a device connected tothe PLC has been compromised and repurposed as a proxy server, enablingindirect access for the attacker. To address such threats, deploying anIntrusion Detection System (IDS) within the internal network isrecommended to monitor and identify suspicious activities—such ashigh-frequency write operations—and trigger alerts accordingly.Additionally, protocol encapsulation techniques may be employed to wrapthe S7Comm protocol with enhanced security features.</p>
<h2 id="Zigbee-Key-Capture"><a href="#Zigbee-Key-Capture" class="headerlink" title="Zigbee Key Capture"></a>Zigbee Key Capture</h2><p>​Zigbee, as the communication protocol between Philips Lamp, Hue andSmart button, has known security vulnerabilities, particularlyconcerning its key management during the device joining process [3,6]. This Section exploit this vulnerability to archive the<strong>information disclosure</strong>.</p>
<h3 id="Exploitation-5"><a href="#Exploitation-5" class="headerlink" title="Exploitation"></a>Exploitation</h3><p>Firstly, connect the Zigbee sniffer device to a Kali Linux machine fornetwork vulnerability testing.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image56.jpeg" srcset="/img/loading.gif" lazyload class="" title="} Figure 44: Zigbee sniffer device connected to Kali Linux. Figure 45 shows the process of capturing ZigBee traffic using Wiresharkwith the help of Whsniff&lt;sup id&#x3D;fnref:3 class&#x3D;footnote-ref&gt;&lt;a href&#x3D;#fn:3 rel&#x3D;footnote&gt;&lt;span class&#x3D;hint--top hint--rounded aria-label&#x3D;&gt;[3]&lt;&#x2F;span&gt;&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;. Under Edit -\&gt; Preferences -\&gt; Protocols-\&gt; ZigBee in Wireshark, a default key is added to decrypt the capturedZigBee packets. {% asset_img image57.png">


<p>Figure 45 Capturing ZigBee traffic with Whsniff and Wireshark</p>
<p>Then try re-searching for light on the phone and pairing it and place itinside the kitchen instead of the original living room.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image59.png" srcset="/img/loading.gif" lazyload class="image58.jpeg} Figure 46 Place light in the living room Using Wireshark again to capture the re-matched handshake packets, focuson the announcement keyword and extract the key field to findsecurity-related information. Key field: f9:09:e2:01:5f:d3:38:98:1c:e6:4e:8d:97:f1:5e:32 {% asset_img">


<p>Figure 47 Captured ZigBee handshake packet with the “announcement”keyword, showing the extracted key field for security analysis</p>
<p>Next, continue to operate the APP to switch on and off the light severaltimes, and re-capture the packet, the result shows the packetinformation without adding the key. It can be observed that while somedata packets are transmitted after the “command” field, such as packetnumbers 434 and 435, the actual data remains undetectable.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image60.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 48 Captured packets transmitted without adding a key, but dataundetectable</p>
<p>Add a pre-configured ZigBee network key to Wireshark’s preferences todecrypt captured ZigBee packets , allowing for clearer analysis of thenetwork traffic.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image61.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 49 Adding the pre-configured ZigBee network key in Wireshark</p>
<p>It can be noted that the previously encrypted ZigBee packet has beensuccessfully decrypted, and the payload can be analysed. The decryptedpayload is now visible under the “Encrypted Payload” section in theWireshark interface.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image62.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 50 Decrypted ZigBee data packets, with the payload now visiblefor analysis</p>
<h3 id="Mitigations-6"><a href="#Mitigations-6" class="headerlink" title="Mitigations"></a>Mitigations</h3><p>The experiment showed that ZigBee encryption keys could be easilyextracted from handshake packets, which directly threatens theconfidentiality of communications. To reduce this risk, static keysshould be avoided, as they can be reused across multiple devices andeasily intercepted. Instead, secure installation procedures should beenforced, including the use of Install Codes, which allow each ZigBeedevice to be paired with a unique, pre-distributed key. This methodensures that even if one pairing session is compromised, other devicesremain secure.</p>
<p>Regular key rotation and disabling insecure open join modes are alsonecessary to prevent long-term exploitation of exposed keys. Wherepossible, upgrading devices to ZigBee 3.0 or newer provides bettersecurity mechanisms, though this may not always be feasible due tohardware constraints. Access to the ZigBee network should be physicallyand logically restricted. Continued monitoring of ZigBee traffic,combined with detection systems that flag unusual device behavior,offers another important layer of protection against unauthorized accessattempts.</p>
<h2 id="Scada-Panel-Tampering"><a href="#Scada-Panel-Tampering" class="headerlink" title="Scada Panel Tampering"></a>Scada Panel Tampering</h2><p>The NODE-RED interface on IP [192.168.88.50] serves toprogram and control the SCADA system (192.168.88.150) through the WebUI.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image64.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 51 NODE-RED interface displaying the connection between ICSdevices and the SCADA server, and receiving messages from the PLC at192.168.2.10.</p>
<p>Figure 51 shows a configuration in Node-RED, where an HTTP request issent to the SCADA system at IP 192.168.88.150:5000, using the GET methodto send a message with the parameter “var_5_title&#x3D;Conveyor”.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image66.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 52 Sending a message to the SCADA system at 192.168.88.150:5000using an HTTP GET request to control or monitor the conveyor.</p>
<p>The payload can be dynamically updated by changing the URL parameters,which now include “var_5_title&#x3D;Conveyor_State” and “var_5_value&#x3D;true”.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image67.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image68.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 53 The payload is dynamically changed by modifying the URLparameters, sending updates to the SCADA system with different values</p>
<h3 id="Mitigations-7"><a href="#Mitigations-7" class="headerlink" title="Mitigations"></a>Mitigations</h3><p>To prevent unauthorized manipulation of the SCADA system through theNode-RED interface, it is essential to implement role-based accesscontrol (RBAC). This ensures that only authorized users have permissionto access or configure critical flow nodes responsible for communicationwith ICS devices. The HTTP input nodes in Node-RED should be restrictedto accept requests only from whitelisted IP addresses or those thatinclude valid authentication tokens, thereby reducing the risk ofcontrol commands being issued from untrusted or external sources.</p>
<h2 id="Smart-Plugin-Unauthorized-Access"><a href="#Smart-Plugin-Unauthorized-Access" class="headerlink" title="Smart Plugin Unauthorized Access"></a>Smart Plugin Unauthorized Access</h2><p>In the terminal, a nmap scan was first executed and port 9999 was foundopen under 192.168.88.186. So the Python script named ‘smart_plug.py’was used several times to get information related to the cloud serviceof this smart socket, including the email address, server address andbinding status.</p>
<img src="/2025/07/05/Penetration-testing-in-IOT-environment/image69.png" srcset="/img/loading.gif" lazyload class="">


<p>Figure 54 Remotely control smart socket devices and get informationabout network and cloud services</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>In this experiment, security risks associated with IoT deviceconfigurations, including <strong>tempering, spoofing, weak authentication,insufficient authorization, and sensitive information disclosure</strong>, wereidentified and demonstrated. Using tools like Nmap, we identified activedevices on multiple network segments and uncovered key vulnerabilitiessuch as unauthenticated access to Node-RED on port 1880 and weakconfigurations in devices like the Siemens S7-1200 PLC. Recommendationsinclude implementing stronger authentication methods, applying strictauthorization controls, disabling unnecessary services, and regularlyupdating systems. It emphasized the need for proactive security measuresto protect sensitive infrastructure in real-world environments.</p>
<p>REFERENCES</p>
<p>[1] Antonakakis, M. et al. 2017. Understanding the mirai botnet. <em>26thUSENIX Security Symposium (USENIX Security 17)</em> (Vancouver, BC, Aug.2017), 1093–1110.</p>
<p>[2] Beresford, D. 2011. Exploiting siemens simatic S7 PLCs. <em>Black HatUSA</em>. 16, 2 (2011), 723–733.</p>
<p>[3] Department of Electronic Engineering, Cape Peninsular Universityof Technology, Cape Town, South Africa et al. 2024. Implementingenhanced security in the zigbee joining process using elliptic curvediffie–hellman algorithm. <em>Electrica</em>. 24, 3 (Nov. 2024), 589–600.DOI:<a target="_blank" rel="noopener" href="https://doi.org/10.5152/electrica.2024.23188">https://doi.org/10.5152/electrica.2024.23188</a>.</p>
<p>[4] Hui, H. et al. 2021. Vulnerability analysis of S7 PLCs:manipulating the security mechanism. <em>International Journal of CriticalInfrastructure Protection</em>. 35, (Dec. 2021), 100470.DOI:<a target="_blank" rel="noopener" href="https://doi.org/10.1016/j.ijcip.2021.100470">https://doi.org/10.1016/j.ijcip.2021.100470</a>.</p>
<p>[5] Noman, H.A. and Abu-Sharkh, O.M.F. 2023. Code injection attacks inwireless-based internet of things (IoT): a comprehensive review andpractical implementations. <em>Sensors</em>. 23, 13 (Jan. 2023), 6067.DOI:<a target="_blank" rel="noopener" href="https://doi.org/10.3390/s23136067">https://doi.org/10.3390/s23136067</a>.</p>
<p>[6] Wang, W. et al. 2020. Analyzing the attack landscape ofzigbee-enabled IoT systems and reinstating users’ privacy. <em>Proceedingsof the 13th ACM Conference on Security and Privacy in Wireless andMobile Networks</em> (New York, NY, USA, Jul. 2020), 133–143.</p>
<p>[7] Wytrębowicz, J. et al. 2021. Messaging protocols for IoTsystems—a pragmatic comparison. <em>Sensors</em>. 21, 20 (Jan. 2021), 6904.DOI:<a target="_blank" rel="noopener" href="https://doi.org/10.3390/s21206904">https://doi.org/10.3390/s21206904</a>.</p>
<section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a target="_blank" rel="noopener" href="https://www.kali.org/tools/metasploit-framework/%23msfvenom">https://www.kali.org/tools/metasploit-framework/#msfvenom</a>
<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span>Java decompiler tool, <a target="_blank" rel="noopener" href="https://github.com/skylot/jadx">https://github.com/skylot/jadx</a>
<a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a target="_blank" rel="noopener" href="https://github.com/homewsn/whsniff">https://github.com/homewsn/whsniff</a>
<a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/IOT%E5%AE%89%E5%85%A8-%E5%B7%A5%E6%8E%A7%E5%AE%89%E5%85%A8/" class="print-no-link">#IOT安全 工控安全</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Penetration testing in industrial IOT environment</div>
      <div>http://k0rz3n.com/2025/07/05/Penetration-testing-in-IOT-environment/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>K0rz3n</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>July 5, 2025</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - Non-commercial">
                    <i class="iconfont icon-cc-nc"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - Share-alike">
                    <i class="iconfont icon-cc-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/07/02/Penetration-testing-of-industrial-control-systems/" title="Penetration testing of Industrial Control Systems(ICS)">
                        <span class="hidden-mobile">Penetration testing of Industrial Control Systems(ICS)</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
