

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon/warning.png">
  <link rel="icon" href="/img/icon/warning.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="K0rz3n">
  <meta name="keywords" content="">
  
    <meta name="description" content="1.IntroductionWireless network has become a crucial part on lives of everyone. Whenpeople go to restaurants, markets or coffee shops, they always want toconnect to the WI-FI, even if that is an open W">
<meta property="og:type" content="article">
<meta property="og:title" content="Wireless security vulnerability exploit">
<meta property="og:url" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/index.html">
<meta property="og:site_name" content="K0rz3n&#39;s Blog">
<meta property="og:description" content="1.IntroductionWireless network has become a crucial part on lives of everyone. Whenpeople go to restaurants, markets or coffee shops, they always want toconnect to the WI-FI, even if that is an open W">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image2.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image3.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image4.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image5.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image6.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image7.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image8.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image9.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image10.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image11.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image12.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image13.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image14.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image15.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image16.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image17.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image18.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image19.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image20.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image21.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image22.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image23.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image24.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image25.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image26.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image27.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image28.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image29.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image30.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image31.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image32.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image33.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image34.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image35.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image36.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image37.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image38.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image39.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image40.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image41.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image42.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image43.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image44.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image45.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image46.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image47.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image48.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image49.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image50.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image51.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image52.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image53.png">
<meta property="og:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image54.png">
<meta property="article:published_time" content="2025-04-25T16:39:10.000Z">
<meta property="article:modified_time" content="2025-08-20T17:56:33.420Z">
<meta property="article:author" content="K0rz3n">
<meta property="article:tag" content="漏洞利用">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/image2.png">
  
  
  
  <title>Wireless security vulnerability exploit - K0rz3n&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/macpanel.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"k0rz3n.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 60vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>K0rz3n&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/banner/icemountain.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Wireless security vulnerability exploit"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-04-25 17:39" pubdate>
          April 25, 2025 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          572 words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          5 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Wireless security vulnerability exploit</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1.Introduction"></a><strong>1.Introduction</strong></h1><p>Wireless network has become a crucial part on lives of everyone. Whenpeople go to restaurants, markets or coffee shops, they always want toconnect to the WI-FI, even if that is an open WI-FI, which means thatthis kind of WI-FI does not need to enter passwords.</p>
<p>That is a big problem, because many dangers are hiding behind WI-FI.Attackers may leverage the flaws in WI-FI protocol or human weaknessesto steal sensitive information during you surfing the internet.</p>
<p>This report mainly focuses on the experiments of the classic wirelessattack and consists of the following parts: <strong>Environment setting,Attack principle, Attack processes</strong> and the corresponding <strong>mitigationmeasures</strong>.</p>
<p>In this experiment, I use a raspberry to simulate a victim and use kalivirtual machine in my laptop with an external wireless network adapteras the attacker endpoint. The whole WI-FI network is created by myrouter.</p>
<p>Laptop, raspberry connect to the WI-FI, and raspberry use ethernet cableto connect to the router. The network architecture shows as followingpicture:</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image2.png" srcset="/img/loading.gif" lazyload class="">



<p>Router gateway: <strong>192.168.88.1</strong></p>
<p>Raspberry: <strong>192.168.88.184(wlan0), 192.168.88.188(eth0)</strong></p>
<h1 id="2-Environment-setting"><a href="#2-Environment-setting" class="headerlink" title="2.Environment setting"></a><strong>2.Environment setting</strong></h1><h2 id="2-1-Router-resetting"><a href="#2-1-Router-resetting" class="headerlink" title="2.1 Router resetting"></a><strong>2.1 Router resetting</strong></h2><p>At the beginning, I met some problems during using my router. I couldnot get the right Ip address of this router, and the default Ip addresswas 169.254.xxx.xxx, which meat that my router could not be assigned aIp address by the DHCP service.</p>
<p>I tried to reset the router, but nothing happened. I had no choice butto flash the router’s firmware and system. I found the official documentfrom the internet and did it by myself.</p>
<p>The following pictures show the method to use the tool called<strong>Netinstall</strong> to flash the router.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image3.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image4.png" srcset="/img/loading.gif" lazyload class="">

<p>The <strong>“Appy default config”</strong> option is quite important, and the flashcould not work if I miss this option.</p>
<blockquote>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image5.png" srcset="/img/loading.gif" lazyload class=""></blockquote>
<p>Finally, I got the Ip address 192.168.88.1, and everything worked well.</p>
<h2 id="2-2-Raspberry-setting"><a href="#2-2-Raspberry-setting" class="headerlink" title="2.2 Raspberry setting"></a><strong>2.2 Raspberry setting</strong></h2><p>In this section, I will talk about the initial experiment environmentsetting. I changed the WI-FI’s name and password and then I needed toconfigure the raspberry to make it connect to the WI-FI of the router.</p>
<p>Firstly, I used ssh to login to the raspberry.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image6.png" srcset="/img/loading.gif" lazyload class="">

<p>When I checked the status of network connection using <strong>iwconfig</strong>command, I found that the default WI-FI connection is MSc-Cyber. So, Ineeded to disconnect it and reconnect it to the WI-FI of router.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image7.png" srcset="/img/loading.gif" lazyload class="">

<p>I used <strong>nmcli</strong> command to connect the raspberry to my own WI-FI.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image8.png" srcset="/img/loading.gif" lazyload class="">

<p>When I checked the connection, I found that the connection has beenbuilt and Ip address was 192.168.88.184.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image9.png" srcset="/img/loading.gif" lazyload class="">

<h1 id="3-Attack-implementation"><a href="#3-Attack-implementation" class="headerlink" title="3.Attack implementation"></a><strong>3.Attack implementation</strong></h1><p>In this section, I will describe 5 kinds of classic wireless attackswith detailed attack processes and corresponding mitigation measures.</p>
<p>The name of the attacks are:</p>
<ul>
<li><p><em><strong>Attacks against four-way handshake</strong></em></p>
</li>
<li><p><em><strong>Attacks against WPS</strong></em></p>
</li>
<li><p><em><strong>Attacks involving mac spoofing</strong></em></p>
</li>
<li><p><em><strong>Man in the middle attack</strong></em></p>
</li>
<li><p><em><strong>Network spoofing attacks (Evil Twin AP)</strong></em></p>
</li>
</ul>
<h2 id="3-1-Attacks-against-four-way-handshake"><a href="#3-1-Attacks-against-four-way-handshake" class="headerlink" title="3.1 Attacks against four-way handshake"></a><strong>3.1 Attacks against four-way handshake</strong></h2><h3 id="Principle"><a href="#Principle" class="headerlink" title="Principle:"></a><strong>Principle:</strong></h3><p>To establish a connection between the client and the WI-FI network, afour-way handshake is required. This handshake process can be capturedusing Wireshark. During the handshake, random numbers and the MIC(Message Integrity Code) are exchanged. The MIC is computed using theWI-FI password, the random numbers, and the Wi-Fi name (SSID).Therefore, an attacker can use a password dictionary to perform anoffline brute-force attack. When the correct password is found, thecomputed MIC will match the one captured in the handshake data.</p>
<h3 id="Attack-process："><a href="#Attack-process：" class="headerlink" title="Attack process："></a><strong>Attack process：</strong></h3><p>I used the tool called <strong>Wifite</strong> to start the monitor mode of thewlan0.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image10.png" srcset="/img/loading.gif" lazyload class="">

<p>I used <strong>airodump-ng</strong> to monitor the BSSID of the Wi-Fi in the network.I found that BSSID of the <strong>“MitroTik-wenbo”</strong> is D4:01:C3:84:95:A1.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image11.png" srcset="/img/loading.gif" lazyload class="">

<p>If I want to attack a client, I need to know which clients wereconnected to this WI-FI, so I specified the BSSID and channel. Theresult as following picture, because we knew that the first mac addresswas my host machine, so the other one must the raspberry that I neededto attack.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image12.png" srcset="/img/loading.gif" lazyload class="">

<p>I used the <strong>airodump-ng</strong> to record the network flows and wrote them tothe PCAP file.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image13.png" srcset="/img/loading.gif" lazyload class="">

<p>Next step, I needed to make victim reconnect the WI-FI and tried to useWireshark so I used <strong>aireplay-ng</strong> to send the deauthenticationpackets.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image14.png" srcset="/img/loading.gif" lazyload class="">

<p>After the packets was sent, I could see the raspberry lost theconnection with the WI-FI “<strong>MikroTik-wenbo”.</strong></p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image15.png" srcset="/img/loading.gif" lazyload class="">

<p>Now, reconnected this WI-FI and saw four-way handshake records in theWireshark.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image16.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image17.png" srcset="/img/loading.gif" lazyload class="">

<p>For gaining the password of the WI-FI, I used the tool called<strong>aircrack-ng</strong> to crack the password, which used the password book inthe kali.</p>
<p>I set the password to a simple “password”, which was quite weak and easyto be cracked, so it did not cost too much time.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image18.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image19.png" srcset="/img/loading.gif" lazyload class="">

<h3 id="Mitigation"><a href="#Mitigation" class="headerlink" title="Mitigation:"></a><strong>Mitigation:</strong></h3><p><strong>1.Use stronger WI-FI password:</strong> Using stronger password is a simpleand effective way to enhance the security of your WI-FI. We need toavoid using easily guessable password, such as “password”. It isrecommended to use passwords including a mix of uppercase and lowercaseletters, special characters and numbers, ensuring the password length isbetween 8-12 characters, which can effectively increase the difficultyof password cracking.</p>
<p><strong>2.Use stronger WI-FI protocol:</strong> We can use the WPA3 protocol, whichuses more secure way of key exchange than WPA2 and can stop attackersfrom guessing the password by brute-force way.</p>
<h2 id="3-2-Attacks-against-WPS"><a href="#3-2-Attacks-against-WPS" class="headerlink" title="3.2 Attacks against WPS"></a><strong>3.2 Attacks against WPS</strong></h2><h3 id="Principle-1"><a href="#Principle-1" class="headerlink" title="Principle:"></a><strong>Principle:</strong></h3><p>WPS (Wi-Fi Protected Setup) attacks target the PIN method in WPSconnections. To simplify the connection process, WPS allows two methodsfor password-free connections: one method uses the client’s pairingbutton, and the other uses a PIN code. The PIN code is an 8-digitnumber, which is vulnerable to brute-force attacks. Because attackerscan just guess the top 7 numbers, and the last number can be calculatedby the top 7 numbers, the number of guesses that attackers need are lessthan 10000000, and also this PIN code can be divided into two parts, sothe actual time the guesses cost will be less.</p>
<h3 id="Attack-process：-1"><a href="#Attack-process：-1" class="headerlink" title="Attack process："></a><strong>Attack process：</strong></h3><p>WPS is a kind of router mode that can allow some devices connect to itwithout using PKS. So in this attack, I need to use the virtual buttonto start this kind of mode. I did not find any place to configure thePIN code, So I thought this router might not be attacked by this way.</p>
<blockquote>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image20.png" srcset="/img/loading.gif" lazyload class=""></blockquote>
<p>I used <strong>airodump-ng</strong> to check the WPS status of the network devices.As you can see the result column from the picture below: WPS status ofthe <strong>“MikroTik-wenbo”</strong> was not locked and the version was 1.0.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image21.png" srcset="/img/loading.gif" lazyload class="">

<p>I tried to use the tool called <strong>reaver</strong> to brute forced the WPS PINcode, but as the picture shows below, I found that the requests havetimed out, which might mean that this kind of requests were not allowedby the router.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image22.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image23.png" srcset="/img/loading.gif" lazyload class="">

<p>After that, I tried another way, using “-K” parameter to try to leveragethe vulnerability of the router, but it was not useful as well, becausethis attack just can be used in some specific router version.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image24.png" srcset="/img/loading.gif" lazyload class="">

<p>So, just like what I mentioned before, this router cannot be attacked bythis method.</p>
<h3 id="Mitigation-measures"><a href="#Mitigation-measures" class="headerlink" title="Mitigation measures:"></a><strong>Mitigation measures:</strong></h3><p><strong>1. Disable WPS or WPS PIN:</strong> If WPS is not needed, disable it in therouter settings, especially the PIN method, which poses significantsecurity risks.</p>
<p><strong>2.Set up a whitelist for connected devices:</strong> Only allow known devicesto connect to the router.</p>
<p><strong>3.Monitor and audit the network:</strong> Analyse the network traffics, iffind anything unusual like request frequently, stop it and enhance thesecurity.</p>
<h2 id="3-3-Attacks-involving-mac-spoofing"><a href="#3-3-Attacks-involving-mac-spoofing" class="headerlink" title="3.3 Attacks involving mac spoofing"></a><strong>3.3 Attacks involving mac spoofing</strong></h2><h3 id="Principle-2"><a href="#Principle-2" class="headerlink" title="Principle:"></a><strong>Principle:</strong></h3><p>WI-FI MAC Spoofing is a technique that involves spoofing a device’s MACaddress to carry out an attack. Since MAC address servers as the uniqueidentifier for devices on a LAN network, if an attacker changes theirdevices’ MAC address to match that of a target device, they may be ableto impersonate the target device, which enable man-in-the-middle attackor bypass security measures that relay on MAC address.</p>
<h3 id="Attack-process：-2"><a href="#Attack-process：-2" class="headerlink" title="Attack process："></a><strong>Attack process：</strong></h3><p>I used the tool called <strong>airodump-ng</strong> to sniff the network and find thetarget that I wanted to attack. I could see that the BSSID of the**”MikroTik-wenbo”** is D4:01:C3:84:95:A1.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image25.png" srcset="/img/loading.gif" lazyload class="">

<p>My purpose was to spoof a device’s mac address in this network, so that,I could bypass some authorization mechanism based on the mac.</p>
<p>Next step, I needed to know the mac of the devices in this network. So,I used the same tool and specify the BSSID and channel.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image26.png" srcset="/img/loading.gif" lazyload class="">

<p>The “STATION” column showed all the devices connecting to this WI-FI.Because I knew the second one is my host machine, the first one must bethe raspberry, which simulated the victim.</p>
<p>I used “ip a” command to check the mac of wlan0, we could find that theMAC address was 86:8C:51:E4:E0:0A and the status of this interface isDOWN.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image27.png" srcset="/img/loading.gif" lazyload class="">

<p>Then I used a tool called <strong>macchanger</strong> to change the MAC of myinterface wlan0 to the victim’s MAC: D8:3A:DD:AF:6B:72</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image28.png" srcset="/img/loading.gif" lazyload class="">

<p>I needed to up this interface wlan0 and check my result of change.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image29.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image30.png" srcset="/img/loading.gif" lazyload class="">

<p>I used Wireshark to monitor the traffics destined for this interfacewlan0. From the result of the traffics, I could find that there was arecord that should be sent to the raspberry but was sent to my laptop,which meant that my spoofing was successful.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image31.png" srcset="/img/loading.gif" lazyload class="">

<h3 id="Mitigation-measures-1"><a href="#Mitigation-measures-1" class="headerlink" title="Mitigation measures:"></a><strong>Mitigation measures:</strong></h3><p><strong>1.Disable MAC-based authentication</strong>: Use stronger way to identify thedevices in the network, such as certificate-based authentication.</p>
<p><strong>2.Bind MAC address and IP in the network:</strong> Make sure that each MACaddress corresponds to a unique IP, and block the cases of duplication.</p>
<p><strong>3.Enable WPA3 encryption:</strong> WPA3 provides stronger encryption andauthentication mechanisms, making it difficult for attacker to decryptnetwork communications even if a MAC address is spoofed.</p>
<h2 id="3-4-Man-in-the-middle-attack"><a href="#3-4-Man-in-the-middle-attack" class="headerlink" title="3.4 Man in the middle attack"></a><strong>3.4 Man in the middle attack</strong></h2><h3 id="Principle-3"><a href="#Principle-3" class="headerlink" title="Principle:"></a><strong>Principle:</strong></h3><img src="/2025/04/25/Wireless-security-vulnerability-exploit/image32.png" srcset="/img/loading.gif" lazyload class="">

<p>Wi-Fi Man-in-the-Middle (MITM) is an attack that intercepts wirelesscommunication to eavesdrop on or tamper with its content. The attackerdevice deceives one party into believing that they are the other,positioning itself invisibly in the middle. A common technique used forthis is ARP spoofing.</p>
<p>ARP is a protocol that transfer Ip address to MAC address, but thisprotocol does not have any certification mechanism. Attacker canbroadcast a disguised ARP response to the LAN and impersonate the routerand the victim. After that, all the traffic between the victim and therouter will pass through the attacker’s device, which can allow attackereavesdrops on or tamper with its content.</p>
<h3 id="Attack-process：-3"><a href="#Attack-process：-3" class="headerlink" title="Attack process："></a><strong>Attack process：</strong></h3><p>I started the monitor mode of the wlan0 first.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image33.png" srcset="/img/loading.gif" lazyload class="">

<p>Then I used the tool <strong>arpspoof</strong> to spoof the gateway 192.168.88.1 thatI was the victim 192.168.88.184 and spoof the victim that I was thegateway at the same time.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image34.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image35.png" srcset="/img/loading.gif" lazyload class="">

<p>Of course, I needed configure the network forward to make sure I cantransfer the requests from victim to the gateway, so that I could hideme between the target devices.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image36.png" srcset="/img/loading.gif" lazyload class="">

<p>I tested whether my attack was successful or not. I pinged the gatewayfrom the client and saw the records in the Wireshark. From the diagrambelow we can see, requests sent and received the response successfully.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image37.png" srcset="/img/loading.gif" lazyload class="">

<p>From the Wireshark, when I used the filter ICMP and specified an IPaddress we can see the ping records successfully.</p>
<p>So, I could make sure that I successfully implement this MITM attack.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image38.png" srcset="/img/loading.gif" lazyload class="">

<h3 id="Mitigation-measures-2"><a href="#Mitigation-measures-2" class="headerlink" title="Mitigation measures:"></a><strong>Mitigation measures:</strong></h3><p><strong>1.Implement Network Isolation:</strong> Separate networks with high-securityrequirements from those with lower security demands. Use certificatesfor authentication to ensure that connected devices are legitimate. Thisalso helps limit the scope of ARP attacks.</p>
<p><strong>2.Conduct Network Auditing and Monitoring</strong>: Utilize monitoring toolsand auditing rules designed to detect and block malicious activities,such as forged certificates or spoofed MAC addresses within the network.</p>
<p><strong>3.Bind MAC address and IP in the network:</strong> Make sure that each MACaddress corresponds to a unique IP, and block the cases of duplication.</p>
<p><strong>4. Enable WPA3 encryption:</strong> WPA3 provides stronger encryption andauthentication mechanisms, making it difficult for attacker to decryptnetwork communications even if a MAC address is spoofed.</p>
<h2 id="3-5-Network-spoofing-attacks-Evil-Twin-AP"><a href="#3-5-Network-spoofing-attacks-Evil-Twin-AP" class="headerlink" title="3.5 Network spoofing attacks (Evil Twin AP)"></a><strong>3.5 Network spoofing attacks (Evil Twin AP)</strong></h2><h3 id="Principle-4"><a href="#Principle-4" class="headerlink" title="Principle"></a><strong>Principle</strong></h3><p>Evil Twin AP is a wireless attack that involves creating a fake accesspoint. The attacker sets up an access point with a known Wi-Fi name todeceive victims into connecting to the malicious AP, thereby stealinguser information or conducting a man-in-the-middle attack.</p>
<h3 id="Attack-process：-4"><a href="#Attack-process：-4" class="headerlink" title="Attack process："></a><strong>Attack process：</strong></h3><p>I started the monitor mode of the wlan0 first</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image39.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image40.png" srcset="/img/loading.gif" lazyload class="">

<p>I used the <strong>airodump-ng</strong> wlan0mon command to sniff the network andfound the target that i needed to attack, this time is**”MikroTik-wenbo”,** and this step created a new interface at0.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image41.png" srcset="/img/loading.gif" lazyload class="">

<p>I started at0 and assign a Ip address.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image42.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image43.png" srcset="/img/loading.gif" lazyload class="">

<p>I configured the DHCP to make sure that the victim would be assigned aIp address when it connected to this evil interface.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image44.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image45.png" srcset="/img/loading.gif" lazyload class="">

<p>I used <strong>airbase-ng</strong> to create a disguised AP and waited some victim toconnect. I started the Wireshark in the interface at0 at the same time.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image46.png" srcset="/img/loading.gif" lazyload class="">

<p>In this scenario, I used the host machine to simulate the victim andconnect to it. We can see that someone has connected and was assigned aIp: 192.168.1.50</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image47.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image48.png" srcset="/img/loading.gif" lazyload class="">

<p>The attack is not over yet, I constructed a disguised Wi-Fi to tricksome sensitive information from victims. So, I created a login page inthe kali and used python to create a http server in port 80, which couldredirect the victims to the login page to force them enter theirpassword.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image49.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image50.png" srcset="/img/loading.gif" lazyload class="">

<p>To make this attack more realistic, I used <strong>iptables</strong> to configure therequests redirection, ensuring that any request initiated by devicesconnected to this fake WI-FI was redirected to the service I set up.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image51.png" srcset="/img/loading.gif" lazyload class="">

<p>When user input their information in the form, this information will besent to the root path of the server, and we can see them from the log orthe Wireshark.</p>
<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image52.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image53.png" srcset="/img/loading.gif" lazyload class="">

<img src="/2025/04/25/Wireless-security-vulnerability-exploit/image54.png" srcset="/img/loading.gif" lazyload class="">

<h3 id="Mitigation-measures-3"><a href="#Mitigation-measures-3" class="headerlink" title="Mitigation measures:"></a><strong>Mitigation measures:</strong></h3><ol>
<li><p><strong>Monitor and audit wireless network:</strong> detect and block any    abnormal WIFI AP in the network, such as WIFI with the same name of    the known WIFI.</p>
</li>
<li><p><strong>Avoiding to connecting to the open WI-FI:</strong> Open WIFI hotpots have    higher security risk and should not be connected to.</p>
</li>
<li><p><strong>Only enter sensitive information on HTTPS websites:</strong> HTTP    protocol transmit information in plain text, which is easier for    man-in-the-middle-attack.</p>
</li>
</ol>
<h1 id="4-References"><a href="#4-References" class="headerlink" title="4. References"></a><strong>4. References</strong></h1><p>Agency, N. S. (2023, Febrary 01). Best Practices for Securing Your HomeNetwork. Retrieved from National Security Agency:<a target="_blank" rel="noopener" href="https://media.defense.gov/2023/Feb/22/2003165170/-1/-1/0/CSI_BEST_PRACTICES_FOR_SECURING_YOUR_HOME_NETWORK.PDF">https://media.defense.gov/2023/Feb/22/2003165170/-1/-1/0/CSI_BEST_PRACTICES_FOR_SECURING_YOUR_HOME_NETWORK.PDF</a></p>
<p>Beaver, K., &amp; T. Davis, P. ( 2005). Hacking Wireless Networks FORDUMMIES. Hoboken: Wiley Publishing, Inc.</p>
<p>CyberKid. (2024, 09 04). Guide to Check Your Router’s Security withWifite. Retrieved from Medium:<a target="_blank" rel="noopener" href="https://medium.com//@redfanatic7/guide-to-check-your-routers-security-with-wifite-461897e66c98">https://medium.com/\@redfanatic7/guide-to-check-your-routers-security-with-wifite-461897e66c98</a></p>
<p>cybersecura. (2022, 09 16). WPA&#x2F;WPA2 cracking, PMKID, Evil Twin...Overview of attacks and threats to Wi-Fi in 2022. Retrieved fromcybersecura:<a target="_blank" rel="noopener" href="https://www.cybersecura.com/en/post/overview-of-attacks-and-threats-to-wifi-in-2022">https://www.cybersecura.com/en/post/overview-of-attacks-and-threats-to-wifi-in-2022</a></p>
<p>Deshmukh, A. (2024, 04 01). Wireless Penetration Testing ComprehensiveGuide. Retrieved from Medium:<a target="_blank" rel="noopener" href="https://rootissh.in/wireless-penetration-testing-comprehensive-guide-4eaa96096892">https://rootissh.in/wireless-penetration-testing-comprehensive-guide-4eaa96096892</a></p>
<p>Ledesma, J. (2023, June 16). Evil Twin Attack: What it is, How to Detect&amp; Prevent it. Retrieved from varonis:<a target="_blank" rel="noopener" href="https://www.varonis.com/blog/evil-twin-attack">https://www.varonis.com/blog/evil-twin-attack</a></p>
<p>outpost24. (2024, 11 08). How hackers use Reaver to exploit WPS andcrack WPA networks. Retrieved from outpost24:<a target="_blank" rel="noopener" href="https://outpost24.com/blog/wps-cracking-with-reaver/">https://outpost24.com/blog/wps-cracking-with-reaver/</a></p>
<p>R1nger. (2022, November 2). Deauthentication Attack using Kali Linux.Retrieved from sudorealm:<a target="_blank" rel="noopener" href="https://sudorealm.com/blog/deauthentication-attack-using-kali-linux">https://sudorealm.com/blog/deauthentication-attack-using-kali-linux</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%97%A0%E7%BA%BF%E5%AE%89%E5%85%A8/" class="category-chain-item">无线安全</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/" class="print-no-link">#漏洞利用</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Wireless security vulnerability exploit</div>
      <div>http://k0rz3n.com/2025/04/25/Wireless-security-vulnerability-exploit/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>K0rz3n</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>April 25, 2025</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - Non-commercial">
                    <i class="iconfont icon-cc-nc"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - Share-alike">
                    <i class="iconfont icon-cc-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/04/30/Cridex-Trojan-Infection-System-Forensic-Analysis/" title="Cridex Trojan Infection System Forensic Analysis Report">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Cridex Trojan Infection System Forensic Analysis Report</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/03/11/ret2shellcode/" title="ret2shellcode">
                        <span class="hidden-mobile">ret2shellcode</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
